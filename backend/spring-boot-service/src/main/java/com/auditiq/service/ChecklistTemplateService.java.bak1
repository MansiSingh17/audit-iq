package com.auditiq.service;

import com.itextpdf.text.*;
import com.itextpdf.text.pdf.*;
import lombok.extern.slf4j.Slf4j;
import org.apache.poi.ss.usermodel.*;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;
import org.springframework.stereotype.Service;
import java.io.ByteArrayOutputStream;
import java.io.IOException;
import java.util.ArrayList;
import java.util.List;

@Slf4j
@Service
public class ChecklistTemplateService {

    public byte[] generateExcelTemplate(String standard) throws IOException {
        try (Workbook workbook = new XSSFWorkbook()) {
            Sheet sheet = workbook.createSheet(standard + " Compliance Checklist");
            CellStyle headerStyle = createHeaderStyle(workbook);
            CellStyle priorityHighStyle = createPriorityStyle(workbook, IndexedColors.RED);
            CellStyle priorityMediumStyle = createPriorityStyle(workbook, IndexedColors.ORANGE);
            CellStyle priorityLowStyle = createPriorityStyle(workbook, IndexedColors.GREEN);

            Row headerRow = sheet.createRow(0);
            String[] headers = {"Control ID", "Control Name", "Description", "Implementation Guidance", "Evidence Required", "Testing Procedure", "Compliance Criteria", "Priority", "Category", "Status", "Evidence Links", "Auditor Notes", "Remediation Plan", "Target Date", "Owner"};
            for (int i = 0; i < headers.length; i++) {
                Cell cell = headerRow.createCell(i);
                cell.setCellValue(headers[i]);
                cell.setCellStyle(headerStyle);
            }

            List<DetailedChecklistItem> items = getDetailedChecklistItems(standard);
            int rowNum = 1;
            for (DetailedChecklistItem item : items) {
                Row row = sheet.createRow(rowNum++);
                row.createCell(0).setCellValue(item.controlId);
                row.createCell(1).setCellValue(item.controlName);
                row.createCell(2).setCellValue(item.detailedDescription);
                row.createCell(3).setCellValue(item.implementationGuidance);
                row.createCell(4).setCellValue(item.evidenceRequired);
                row.createCell(5).setCellValue(item.testingProcedure);
                row.createCell(6).setCellValue(item.complianceCriteria);
                Cell priorityCell = row.createCell(7);
                priorityCell.setCellValue(item.priority);
                switch (item.priority.toUpperCase()) {
                    case "HIGH":
                    case "CRITICAL":
                        priorityCell.setCellStyle(priorityHighStyle);
                        break;
                    case "MEDIUM":
                        priorityCell.setCellStyle(priorityMediumStyle);
                        break;
                    case "LOW":
                        priorityCell.setCellStyle(priorityLowStyle);
                        break;
                }
                row.createCell(8).setCellValue(item.category);
                row.createCell(9).setCellValue("Not Started");
                for (int i = 10; i <= 14; i++) row.createCell(i).setCellValue("");
            }

            for (int i = 0; i < headers.length; i++) {
                sheet.setColumnWidth(i, i < 7 ? (i == 2 || i == 3 ? 20000 : (i == 4 || i == 5 || i == 6 ? 15000 : (i == 1 ? 10000 : 4000))) : (i < 10 ? (i == 8 ? 6000 : 3000) : 8000));
            }

            ByteArrayOutputStream outputStream = new ByteArrayOutputStream();
            workbook.write(outputStream);
            log.info("✅ Generated Excel with {} detailed items", items.size());
            return outputStream.toByteArray();
        }
    }

    public byte[] generatePdfTemplate(String standard) throws IOException {
        try {
            Document document = new Document(PageSize.A4.rotate(), 36, 36, 54, 54);
            ByteArrayOutputStream outputStream = new ByteArrayOutputStream();
            PdfWriter.getInstance(document, outputStream);
            document.open();

            Font titleFont = FontFactory.getFont(FontFactory.HELVETICA_BOLD, 20, BaseColor.DARK_GRAY);
            Paragraph title = new Paragraph(standard + " Compliance Checklist", titleFont);
            title.setAlignment(Element.ALIGN_CENTER);
            title.setSpacingAfter(10);
            document.add(title);

            Font subtitleFont = FontFactory.getFont(FontFactory.HELVETICA, 10, BaseColor.GRAY);
            Paragraph subtitle = new Paragraph("Generated by AuditIQ - " + new java.util.Date(), subtitleFont);
            subtitle.setAlignment(Element.ALIGN_CENTER);
            subtitle.setSpacingAfter(20);
            document.add(subtitle);

            List<DetailedChecklistItem> items = getDetailedChecklistItems(standard);
            PdfPTable table = new PdfPTable(8);
            table.setWidthPercentage(100);
            table.setWidths(new float[]{10f, 15f, 25f, 20f, 15f, 8f, 7f, 5f});

            Font headerFont = FontFactory.getFont(FontFactory.HELVETICA_BOLD, 8, BaseColor.WHITE);
            BaseColor headerBg = new BaseColor(37, 99, 235);
            for (String h : new String[]{"ID", "Control", "Description", "Evidence", "Testing", "Priority", "Category", "Status"}) {
                PdfPCell cell = new PdfPCell(new Phrase(h, headerFont));
                cell.setBackgroundColor(headerBg);
                cell.setHorizontalAlignment(Element.ALIGN_CENTER);
                cell.setPadding(8);
                table.addCell(cell);
            }

            Font cellFont = FontFactory.getFont(FontFactory.HELVETICA, 7, BaseColor.BLACK);
            for (DetailedChecklistItem item : items) {
                table.addCell(new PdfPCell(new Phrase(item.controlId, cellFont)));
                table.addCell(new PdfPCell(new Phrase(item.controlName, cellFont)));
                table.addCell(new PdfPCell(new Phrase(item.detailedDescription, cellFont)));
                table.addCell(new PdfPCell(new Phrase(item.evidenceRequired, cellFont)));
                table.addCell(new PdfPCell(new Phrase(item.testingProcedure, cellFont)));
                PdfPCell priorityCell = new PdfPCell(new Phrase(item.priority, FontFactory.getFont(FontFactory.HELVETICA_BOLD, 7, getPriorityColor(item.priority))));
                priorityCell.setHorizontalAlignment(Element.ALIGN_CENTER);
                table.addCell(priorityCell);
                table.addCell(new PdfPCell(new Phrase(item.category, cellFont)));
                PdfPCell statusCell = new PdfPCell(new Phrase("☐", FontFactory.getFont(FontFactory.HELVETICA, 10)));
                statusCell.setHorizontalAlignment(Element.ALIGN_CENTER);
                table.addCell(statusCell);
            }

            document.add(table);
            document.add(new Paragraph(" "));
            long highCount = items.stream().filter(i -> "HIGH".equalsIgnoreCase(i.priority) || "CRITICAL".equalsIgnoreCase(i.priority)).count();
            Paragraph footer = new Paragraph(String.format("Total: %d | High Priority: %d", items.size(), highCount), FontFactory.getFont(FontFactory.HELVETICA_OBLIQUE, 8, BaseColor.GRAY));
            footer.setAlignment(Element.ALIGN_CENTER);
            document.add(footer);
            document.close();
            return outputStream.toByteArray();
        } catch (DocumentException e) {
            throw new IOException("Failed to generate PDF", e);
        }
    }

    private void addTableHeader(PdfPTable table, String text, com.itextpdf.text.Font font, BaseColor bgColor) {
        PdfPCell cell = new PdfPCell(new Phrase(text, font));
        cell.setBackgroundColor(bgColor);
        cell.setHorizontalAlignment(Element.ALIGN_CENTER);
        cell.setPadding(8);
        table.addCell(cell);
    }

    private PdfPCell createCell(String text, com.itextpdf.text.Font font) {
        return new PdfPCell(new Phrase(text, font));
    }

    private BaseColor getPriorityColor(String priority) {
        switch (priority.toUpperCase()) {
            case "CRITICAL":
            case "HIGH": return new BaseColor(220, 38, 38);
            case "MEDIUM": return new BaseColor(245, 158, 11);
            case "LOW": return new BaseColor(16, 185, 129);
            default: return BaseColor.BLACK;
        }
    }

    private CellStyle createHeaderStyle(Workbook workbook) {
        CellStyle style = workbook.createCellStyle();
        org.apache.poi.ss.usermodel.Font poiFont = workbook.createFont();
        poiFont.setBold(true);
        poiFont.setFontHeightInPoints((short) 12);
        poiFont.setColor(IndexedColors.WHITE.getIndex());
        style.setFont(poiFont);
        style.setFillForegroundColor(IndexedColors.DARK_BLUE.getIndex());
        style.setFillPattern(FillPatternType.SOLID_FOREGROUND);
        style.setBorderBottom(BorderStyle.THIN);
        style.setBorderTop(BorderStyle.THIN);
        style.setBorderRight(BorderStyle.THIN);
        style.setBorderLeft(BorderStyle.THIN);
        style.setAlignment(HorizontalAlignment.CENTER);
        style.setVerticalAlignment(VerticalAlignment.CENTER);
        return style;
    }

    private CellStyle createPriorityStyle(Workbook workbook, IndexedColors color) {
        CellStyle style = workbook.createCellStyle();
        org.apache.poi.ss.usermodel.Font poiFont = workbook.createFont();
        poiFont.setBold(true);
        poiFont.setColor(color.getIndex());
        style.setFont(poiFont);
        style.setAlignment(HorizontalAlignment.CENTER);
        return style;
    }

    private List<DetailedChecklistItem> getDetailedChecklistItems(String standard) {
        switch (standard.toUpperCase()) {
            case "ISO_27001":
            case "ISO 27001":
            case "ISO_27001:2022":
                return getISO27001CompleteChecklist();
            case "GDPR":
                return getGDPRCompleteChecklist();
            case "HIPAA":
                return getHIPAACompleteChecklist();
            default:
                return getGenericChecklist(standard);
        }
    }

    // ISO 27001:2022 - ALL 93 CONTROLS
    private List<DetailedChecklistItem> getISO27001CompleteChecklist() {
        List<DetailedChecklistItem> items = new ArrayList<>();
        
        // A.5 ORGANIZATIONAL CONTROLS (37)
        String[][] a5 = {
            {"A.5.1", "Policies for information security", "Policy defined, approved, published, communicated and acknowledged", "1. Develop policy 2. Get management approval 3. Communicate to all 4. Obtain acknowledgments 5. Review annually", "• Signed policy • Approval records • Acknowledgments • Review minutes", "1. Verify policy exists 2. Check signatures 3. Sample acknowledgments 4. Review history", "✓ Policy approved within 12 months ✓ All acknowledged", "CRITICAL", "Organizational"},
            {"A.5.2", "Information security roles", "Roles and responsibilities defined and allocated", "1. Create RACI matrix 2. Define CISO 3. Assign responsibilities 4. Document roles 5. Communicate", "• Org chart • RACI matrix • Job descriptions • Assignments", "1. Review org chart 2. Verify RACI 3. Check job descriptions", "✓ CISO defined ✓ All roles documented", "CRITICAL", "Organizational"},
            {"A.5.3", "Segregation of duties", "Conflicting duties segregated", "1. Identify critical processes 2. Map access 3. Implement dev/prod separation 4. Use RBAC 5. Monitor violations", "• SoD matrix • Access policies • Role definitions • Violation reports", "1. Review SoD matrix 2. Test sample accounts 3. Check monitoring", "✓ Critical processes segregated ✓ Monitoring in place", "CRITICAL", "Access Control"},
            {"A.5.4", "Management responsibilities", "Management requires personnel to apply security", "1. Include security in job descriptions 2. Implement metrics 3. Conduct awareness 4. Establish consequences 5. Monitor compliance", "• Job descriptions • Performance evaluations • Awareness materials • Audit reports", "1. Sample job descriptions 2. Review evaluations 3. Check awareness participation", "✓ Security in all job descriptions ✓ Culture evident", "HIGH", "Organizational"},
            {"A.5.5", "Contact with authorities", "Contact with relevant authorities maintained", "1. Identify authorities 2. Establish contacts 3. Document in IR plan 4. Annual review 5. Test channels", "• Authority list with contacts • Contact verification • IR plan • Test results", "1. Verify contact list current 2. Check last verified 3. Review IR plan contacts", "✓ All authorities identified ✓ Verified within 12 months", "MEDIUM", "Incident Mgmt"},
            {"A.5.6", "Contact with special interest groups", "Contact with security forums maintained", "1. Identify relevant groups 2. Join ISACs 3. Participate in forums 4. Share information 5. Apply learnings", "• ISAC memberships • Forum participation records • Information sharing logs", "1. Verify group memberships 2. Check participation 3. Review learnings applied", "✓ Active memberships ✓ Regular participation", "MEDIUM", "Threat Intel"},
            {"A.5.7", "Threat intelligence", "Threat information collected and analyzed", "1. Subscribe to threat feeds 2. Monitor vulnerability DBs 3. Participate in ISACs 4. Analyze threats 5. Share internally 6. Update controls", "• Threat feed subscriptions • Analysis reports • ISAC membership • Threat briefings • Control updates", "1. Verify subscriptions 2. Review analysis 3. Check update frequency 4. Validate control updates", "✓ Multiple threat sources ✓ Monthly analysis ✓ Controls updated", "HIGH", "Risk Mgmt"},
            {"A.5.8", "Information security in project management", "Security integrated into project management", "1. Include security in charters 2. Conduct security risk assessments 3. Assign security champion 4. Implement checkpoints 5. Perform gate reviews", "• Project templates • Security risk assessments • Champion assignments • Gate reviews", "1. Review sample projects 2. Verify security in charters 3. Check assessments 4. Validate reviews", "✓ All projects include security ✓ Reviews at all gates", "HIGH", "Project Mgmt"},
            {"A.5.9", "Inventory of assets", "Asset inventory developed and maintained", "1. Identify all assets 2. Classify by value 3. Assign owners 4. Document locations 5. Update quarterly", "• Asset inventory • Classification scheme • Ownership records • Quarterly reviews", "1. Verify inventory complete 2. Sample assets 3. Check classifications 4. Validate updates", "✓ Complete inventory ✓ Quarterly updates", "CRITICAL", "Asset Mgmt"},
            {"A.5.10", "Acceptable use", "Rules for acceptable use defined", "1. Define AUP 2. Specify prohibited activities 3. Communicate to users 4. Require acknowledgment 5. Monitor compliance", "• AUP document • User acknowledgments • Monitoring logs • Violation reports", "1. Review AUP 2. Verify acknowledgments 3. Check monitoring 4. Review violations", "✓ AUP defined ✓ All acknowledged ✓ Monitoring active", "HIGH", "Info Security"},
            {"A.5.11", "Return of assets", "Personnel return all assets upon termination", "1. Create asset return checklist 2. Include in offboarding 3. Track issued assets 4. Implement surrender process 5. Verify data deletion", "• Asset issuance records • Offboarding checklists • Return confirmations • Deletion certificates", "1. Review offboarding 2. Sample terminated employees 3. Verify asset return 4. Check data deletion", "✓ Asset return in offboarding ✓ All assets returned", "MEDIUM", "Asset Mgmt"},
            {"A.5.12", "Classification of information", "Information classified by legal, value, criticality, sensitivity", "1. Develop classification scheme 2. Define criteria 3. Assign classifications 4. Train users 5. Implement labeling 6. Review annually", "• Classification policy • Classification scheme • Information inventory • Training records • Labels", "1. Review classification scheme 2. Sample documents 3. Verify labels 4. Check user awareness", "✓ Scheme defined ✓ All information classified ✓ Users trained", "HIGH", "Info Mgmt"},
            {"A.5.13", "Labelling of information", "Labelling procedures developed and implemented", "1. Create labeling standards 2. Implement metadata tagging 3. Apply visual labels 4. Configure email classification 5. Label digital files 6. Automate labeling", "• Labeling procedures • Label templates • Email classification • Marking examples • Automation tools", "1. Verify procedures 2. Sample documents 3. Check email classification 4. Test automation", "✓ Procedures documented ✓ All sensitive info labeled ✓ Automation where feasible", "MEDIUM", "Info Mgmt"},
            {"A.5.14", "Information transfer", "Transfer rules and procedures in place", "1. Define secure transfer methods 2. Establish encryption requirements 3. Create transfer agreements 4. Implement SFTP/FTPS 5. Log transfers 6. Validate recipient authorization", "• Transfer policy • Secure protocols • Transfer agreements • Transfer logs • Encryption verification • Authorization matrix", "1. Review transfer policy 2. Verify encryption 3. Check logging 4. Validate authorization 5. Test protocols 6. Review agreements", "✓ All transfers use secure methods ✓ Encryption enforced ✓ All transfers logged ✓ Authorization verified", "CRITICAL", "Data Transfer"},
            {"A.5.15", "Access control", "Rules to control physical and logical access established", "1. Implement least privilege 2. Use RBAC 3. Implement MFA 4. Review access quarterly 5. Enforce strong passwords 6. Log all access", "• Access control policy • RBAC implementation • MFA configuration • Quarterly reviews • Password policy • Access logs", "1. Review policy 2. Verify least privilege 3. Test MFA 4. Check reviews 5. Test passwords 6. Review logs", "✓ Policy documented ✓ Least privilege ✓ MFA required ✓ Quarterly reviews", "CRITICAL", "Access Control"},
            {"A.5.16", "Identity management", "Full lifecycle of identities managed", "1. Implement provisioning 2. Assign unique identifiers 3. Establish verification 4. Implement modification 5. Create de-provisioning 6. Maintain audit trail", "• Identity procedures • Provisioning records • Unique ID scheme • De-provisioning checklists • Audit trail", "1. Review procedures 2. Test provisioning 3. Verify unique IDs 4. Check modifications 5. Test de-provisioning", "✓ Lifecycle managed ✓ Unique IDs ✓ Provisioning/de-provisioning controlled", "HIGH", "Identity & Access"},
            {"A.5.17", "Authentication information", "Authentication info allocation and management controlled", "1. Implement secure password generation 2. Enforce complexity 3. Require changes (90 days) 4. Prevent reuse (last 12) 5. Secure storage (hashed) 6. Implement lockout 7. Monitor failures", "• Password policy • Hashing algorithms (bcrypt) • Password history • Account lockout config • Auth logs • MFA implementation", "1. Review password requirements 2. Test aging 3. Verify history prevents reuse 4. Check hashing 5. Test lockout 6. Review monitoring", "✓ Strong password policy ✓ Hashed securely ✓ Lockout configured ✓ MFA required ✓ Reuse prevented", "CRITICAL", "Authentication"},
            {"A.5.18", "Access rights", "Access rights provisioned, reviewed, modified and removed", "1. Implement request process 2. Require approval 3. Grant based on need 4. Conduct quarterly reviews 5. Remove upon role change 6. Revoke upon termination (same day)", "• Access request forms • Approval workflows • Provisioning logs • Quarterly reviews • Modification records • Termination revocation", "1. Test request process 2. Verify approvals 3. Check reviews 4. Sample changes 5. Test same-day revocation", "✓ All access approved ✓ Quarterly reviews ✓ Aligned with need ✓ Terminations same day", "CRITICAL", "Access Control"},
            {"A.5.19", "Supplier security", "Processes to manage supplier security risks defined", "1. Supplier security policy 2. Supplier risk assessments 3. Security requirements in contracts 4. Supplier security reviews 5. Monitor supplier compliance", "• Supplier security policy • Risk assessments • Contract security clauses • Supplier reviews • Compliance monitoring", "1. Review supplier policy 2. Check risk assessments 3. Verify contract clauses 4. Review supplier compliance", "✓ Policy defined ✓ All suppliers assessed ✓ Security in contracts", "HIGH", "Supplier Mgmt"},
            {"A.5.20", "Supplier agreements", "Security requirements established with suppliers", "1. Define security requirements 2. Include in supplier agreements 3. Specify data handling 4. Require incident notification 5. Include audit rights 6. Review annually", "• Supplier agreements • Security requirements • Data handling terms • Incident notification clauses • Audit rights • Annual reviews", "1. Review agreements 2. Check security requirements 3. Verify data handling terms 4. Confirm incident notification 5. Verify audit rights 6. Check annual reviews", "✓ Security requirements in all agreements ✓ Data handling specified ✓ Annual reviews", "HIGH", "Supplier Mgmt"},
            {"A.5.21", "ICT supply chain security", "Processes for ICT supply chain security defined", "1. Identify ICT supply chain 2. Assess supply chain risks 3. Define security requirements 4. Implement controls 5. Monitor supply chain security", "• Supply chain mapping • Risk assessments • Security requirements • Control implementation • Monitoring reports", "1. Review supply chain mapping 2. Check risk assessments 3. Verify security requirements 4. Review monitoring", "✓ Supply chain mapped ✓ Risks assessed ✓ Controls implemented", "MEDIUM", "Supply Chain"},
            {"A.5.22", "Monitoring of supplier services", "Organization monitors and manages supplier changes", "1. Monitor supplier performance 2. Review supplier security 3. Evaluate supplier changes 4. Manage supplier incidents 5. Conduct supplier audits", "• Supplier monitoring procedures • Performance reviews • Security evaluations • Change management • Incident records • Audit results", "1. Review monitoring procedures 2. Check performance reviews 3. Verify evaluations 4. Review change management 5. Check audit completion", "✓ Monitoring procedures in place ✓ Regular reviews ✓ Changes managed", "MEDIUM", "Supplier Mgmt"},
            {"A.5.23", "Cloud services security", "Processes for cloud services established", "1. Define cloud security policy 2. Assess cloud service providers 3. Establish security requirements 4. Implement cloud controls 5. Monitor cloud security 6. Plan for exit", "• Cloud security policy • CSP assessments • Security requirements • Cloud control implementation • Monitoring procedures • Exit strategy", "1. Review cloud policy 2. Check CSP assessments 3. Verify security requirements 4. Review cloud controls 5. Check monitoring 6. Verify exit plan", "✓ Cloud policy defined ✓ CSPs assessed ✓ Security requirements established ✓ Exit strategy documented", "HIGH", "Cloud Security"},
            {"A.5.24", "Incident management planning", "Organization plans for managing incidents", "1. Develop IR plan 2. Establish IRT 3. Define categories 4. Create reporting procedures 5. Implement tracking 6. Conduct exercises quarterly", "• IR plan • IRT roster • Categorization matrix • Reporting procedures • Tracking system • Exercise reports", "1. Review IR plan 2. Verify IRT trained 3. Check categorization 4. Test reporting 5. Review incidents 6. Verify exercises", "✓ Current IR plan ✓ IRT trained ✓ 24/7 reporting ✓ Quarterly exercises", "CRITICAL", "Incident Mgmt"},
            {"A.5.25", "Assessment of security events", "Organization assesses events and categorizes incidents", "1. Define event assessment criteria 2. Implement event logging 3. Analyze security events 4. Categorize as incidents when appropriate 5. Escalate per procedures", "• Event assessment procedures • Event logs • Analysis procedures • Incident categorization criteria • Escalation matrix", "1. Review assessment procedures 2. Check event logging 3. Review event analysis 4. Verify categorization criteria 5. Test escalation", "✓ Assessment criteria defined ✓ Events logged and analyzed ✓ Proper categorization", "HIGH", "Incident Mgmt"},
            {"A.5.26", "Response to incidents", "Incidents responded to per documented procedures", "1. Establish response procedures 2. Assign response roles 3. Contain incidents 4. Eradicate threats 5. Recover systems 6. Document lessons learned", "• Response procedures • Role assignments • Containment procedures • Eradication procedures • Recovery procedures • Lessons learned", "1. Review response procedures 2. Verify roles assigned 3. Check containment procedures 4. Review recovery procedures 5. Verify lessons learned", "✓ Response procedures documented ✓ Roles assigned ✓ Lessons learned captured", "HIGH", "Incident Mgmt"},
            {"A.5.27", "Learning from incidents", "Knowledge from incidents used to strengthen controls", "1. Conduct post-incident reviews 2. Identify root causes 3. Implement improvements 4. Update procedures 5. Share lessons learned 6. Track improvement implementation", "• Post-incident review reports • Root cause analysis • Improvement action plans • Procedure updates • Lessons learned documentation • Improvement tracking", "1. Review post-incident reviews 2. Check root cause analysis 3. Verify improvements implemented 4. Review procedure updates 5. Validate lessons shared", "✓ Post-incident reviews conducted ✓ Improvements implemented ✓ Lessons shared", "MEDIUM", "Incident Mgmt"},
            {"A.5.28", "Collection of evidence", "Procedures for evidence collection established", "1. Define evidence collection procedures 2. Identify evidence types 3. Implement chain of custody 4. Preserve evidence integrity 5. Document evidence handling 6. Train personnel", "• Evidence collection procedures • Evidence types defined • Chain of custody forms • Preservation procedures • Handling documentation • Training records", "1. Review collection procedures 2. Verify evidence types identified 3. Check chain of custody 4. Test preservation 5. Review handling 6. Verify training", "✓ Procedures established ✓ Chain of custody maintained ✓ Personnel trained", "HIGH", "Forensics"},
            {"A.5.29", "Security during disruption", "Security maintained during disruption", "1. Identify critical security controls 2. Plan for disruption scenarios 3. Implement redundancy 4. Test continuity plans 5. Document security continuity", "• Security continuity plan • Critical control identification • Disruption scenarios • Redundancy implementation • Test results", "1. Review security continuity plan 2. Verify critical controls identified 3. Check redundancy 4. Review test results", "✓ Security continuity planned ✓ Critical controls maintained ✓ Tests passed", "HIGH", "Business Continuity"},
            {"A.5.30", "ICT readiness for business continuity", "ICT readiness planned and tested", "1. Define ICT availability objectives 2. Implement redundancy 3. Test failover procedures 4. Maintain DR site 5. Update plans regularly", "• ICT continuity plan • Availability objectives • Redundancy implementation • Failover test results • DR site documentation", "1. Review ICT continuity plan 2. Verify redundancy 3. Test failover 4. Check DR site ready 5. Verify plan updates", "✓ ICT continuity planned ✓ Redundancy in place ✓ Annual tests passed", "HIGH", "Business Continuity"},
            {"A.5.31", "Legal and regulatory requirements", "Requirements identified, documented and kept up to date", "1. Identify applicable laws 2. Document requirements 3. Assign compliance responsibilities 4. Implement compliance controls 5. Review requirements annually", "• Legal requirements register • Compliance documentation • Responsibility assignments • Compliance controls • Annual reviews", "1. Review requirements register 2. Verify completeness 3. Check responsibility assignments 4. Review controls 5. Verify annual updates", "✓ All requirements identified ✓ Documented and assigned ✓ Annual reviews", "HIGH", "Legal Compliance"},
            {"A.5.32", "Intellectual property rights", "Procedures to protect IPR implemented", "1. Identify IPR 2. Define protection procedures 3. Implement licensing controls 4. Monitor IPR compliance 5. Train personnel", "• IPR register • Protection procedures • Software licensing records • Compliance monitoring • Training records", "1. Review IPR register 2. Check protection procedures 3. Verify licensing compliance 4. Review monitoring", "✓ IPR identified and protected ✓ Licensing compliant ✓ Personnel trained", "MEDIUM", "Legal Compliance"},
            {"A.5.33", "Protection of records", "Records protected from loss, destruction, falsification, unauthorized access", "1. Identify records requiring protection 2. Implement retention schedules 3. Implement access controls 4. Protect record integrity 5. Implement backup 6. Conduct regular reviews", "• Records retention schedule • Access controls • Integrity protection • Backup evidence • Review records", "1. Review retention schedule 2. Verify access controls 3. Test integrity protection 4. Check backups 5. Verify regular reviews", "✓ Retention schedule defined ✓ Access controlled ✓ Integrity protected ✓ Backed up", "HIGH", "Records Mgmt"},
            {"A.5.34", "Privacy and protection of PII", "Privacy and PII protection requirements met", "1. Identify PII processing 2. Implement privacy controls 3. Obtain consent where required 4. Provide privacy notices 5. Honor data subject rights 6. Implement data minimization", "• PII inventory • Privacy controls • Consent records • Privacy notices • Data subject rights procedures • Data minimization evidence", "1. Review PII inventory 2. Verify privacy controls 3. Check consent 4. Review privacy notices 5. Test data subject rights 6. Validate minimization", "✓ PII identified ✓ Privacy controls implemented ✓ Consent obtained ✓ Rights honored", "HIGH", "Privacy"},
            {"A.5.35", "Independent review", "Information security reviewed independently at intervals", "1. Schedule independent reviews 2. Define review scope 3. Engage independent reviewers 4. Document review findings 5. Track remediation 6. Report to management", "• Review schedule • Review scope documentation • Independent reviewer qualifications • Review reports • Remediation tracking • Management reports", "1. Verify review schedule 2. Check reviewer independence 3. Review report completeness 4. Verify remediation tracking 5. Confirm management reporting", "✓ Independent reviews scheduled ✓ Reviews completed ✓ Findings remediated ✓ Management informed", "MEDIUM", "Governance"},
            {"A.5.36", "Compliance with policies", "Compliance regularly reviewed", "1. Define compliance review procedures 2. Conduct regular compliance checks 3. Document compliance status 4. Report non-compliance 5. Track remediation", "• Compliance review procedures • Compliance check reports • Compliance status documentation • Non-compliance reports • Remediation tracking", "1. Review procedures 2. Check regular reviews 3. Verify compliance documented 4. Review non-compliance 5. Validate remediation", "✓ Regular compliance reviews ✓ Non-compliance addressed ✓ Remediation tracked", "MEDIUM", "Compliance"},
            {"A.5.37", "Documented operating procedures", "Operating procedures documented and available", "1. Document all operating procedures 2. Maintain procedure library 3. Make accessible to personnel 4. Review and update regularly 5. Train personnel on procedures", "• Operating procedure documentation • Procedure library • Access logs • Update records • Training records", "1. Review procedure documentation 2. Verify completeness 3. Check accessibility 4. Review update frequency 5. Verify training", "✓ Procedures documented ✓ Accessible to personnel ✓ Regularly updated ✓ Personnel trained", "MEDIUM", "Operations"}
        };
        for (String[] ctrl : a5) items.add(new DetailedChecklistItem(ctrl[0], ctrl[1], ctrl[2], ctrl[3], ctrl[4], ctrl[5], ctrl[6], ctrl[7], ctrl[8]));

        // A.6 PEOPLE CONTROLS (8)
        String[][] a6 = {
            {"A.6.1", "Screening", "Background checks prior to employment", "1. Define screening requirements 2. Conduct criminal checks 3. Verify employment history 4. Check qualifications 5. Obtain references 6. Ongoing screening for sensitive roles", "• Background check policy • Screening reports • Employment verification • Reference checks • Ongoing screening schedule", "1. Review policy 2. Sample recent hires 3. Verify checks before start 4. Check screening appropriate 5. Verify ongoing screening", "✓ All employees screened ✓ Appropriate to role ✓ Criminal checks for all ✓ Ongoing for sensitive roles", "HIGH", "HR Security"},
            {"A.6.2", "Terms of employment", "Employment agreements state security responsibilities", "1. Include security clauses 2. Define confidentiality obligations 3. Include NDAs 4. Define post-employment terms 5. Require signatures", "• Contract templates • Signed agreements • NDA documents • Security clauses", "1. Review templates 2. Sample signed contracts 3. Verify NDAs 4. Check obligations clear", "✓ All contracts include security ✓ NDAs executed ✓ Obligations clear", "HIGH", "HR Security"},
            {"A.6.3", "Security awareness training", "Personnel receive appropriate training", "1. Develop annual training 2. Provide role-based training 3. Conduct phishing simulations 4. Deliver specialized IT training 5. Security onboarding 6. Track completion 7. Assess effectiveness", "• Training program • Training materials • Completion records (100%) • Phishing simulation results • Specialized curriculum • Onboarding records • Effectiveness assessments", "1. Review program scope 2. Verify 100% completion 3. Check phishing metrics 4. Validate role-based training 5. Review effectiveness 6. Test user knowledge", "✓ Annual training for all ✓ 100% completion ✓ Phishing click rate < 5% ✓ Effectiveness measured", "CRITICAL", "Security Awareness"},
            {"A.6.4", "Disciplinary process", "Formal disciplinary process for violations", "1. Define disciplinary policy 2. Establish violation categories 3. Define consequences 4. Implement fair process 5. Document all actions 6. Communicate process", "• Disciplinary policy • Violation categories • Consequence matrix • Process documentation • Disciplinary action records • Communication records", "1. Review disciplinary policy 2. Verify categories defined 3. Check consequences clear 4. Review process fairness 5. Sample disciplinary actions 6. Verify communication", "✓ Disciplinary policy defined ✓ Fair process established ✓ Actions documented ✓ Personnel aware", "MEDIUM", "HR Security"},
            {"A.6.5", "Responsibilities after termination", "Post-termination responsibilities defined and enforced", "1. Document post-termination obligations 2. Include in exit interviews 3. Remind of confidentiality 4. Collect all property 5. Deactivate all access immediately 6. Monitor for policy violations", "• Post-termination obligations • Exit interview checklists • Confidentiality reminders • Asset return confirmations • Access revocation records • Post-termination monitoring", "1. Review post-termination procedures 2. Sample exit interviews 3. Verify obligations communicated 4. Check asset return 5. Confirm immediate access revocation 6. Review monitoring", "✓ Post-termination duties documented ✓ Communicated at exit ✓ All access revoked same day ✓ All assets returned", "HIGH", "HR Security"},
            {"A.6.6", "Confidentiality agreements", "Confidentiality/non-disclosure agreements reviewed and updated", "1. Develop NDA template 2. Require NDAs for all personnel 3. Include relevant parties 4. Review and update agreements 5. Maintain signed NDAs 6. Enforce obligations", "• NDA template • Signed NDA records • Agreement review schedule • Update records • Enforcement evidence", "1. Review NDA template 2. Verify all personnel signed 3. Check agreement updates 4. Review enforcement", "✓ NDAs for all personnel ✓ Agreements current ✓ Obligations enforced", "MEDIUM", "Confidentiality"},
            {"A.6.7", "Remote working", "Security measures for remote working implemented", "1. Develop remote work policy 2. Require VPN 3. Enforce device encryption 4. Implement EDR 5. Require secure Wi-Fi (WPA3) 6. Provide secure access tools 7. Monitor remote access", "• Remote work policy • VPN configuration • Device encryption evidence • EDR deployment • Wi-Fi guidelines • Remote access tools • Access monitoring reports", "1. Review policy 2. Verify VPN mandatory 3. Check all devices encrypted 4. Validate EDR deployed 5. Test VPN controls 6. Review remote access logs 7. Interview remote workers", "✓ Remote work policy ✓ VPN required and enforced ✓ All devices encrypted ✓ EDR on all endpoints ✓ Remote access monitored", "CRITICAL", "Remote Access"},
            {"A.6.8", "Event reporting", "Mechanism to report security events provided", "1. Establish reporting channels 2. Create reporting forms 3. Implement 24/7 reporting 4. Define timeframes 5. Protect reporters 6. Acknowledge reports 7. Track investigations", "• Reporting procedures • Channel documentation • 24/7 helpdesk • Incident report logs • Investigation records • Non-retaliation policy", "1. Verify channels available 2. Test 24/7 accessibility 3. Review reports 4. Check timeframes met 5. Verify investigations 6. Confirm acknowledgments 7. Test mechanism usability", "✓ Reporting 24/7 ✓ Multiple channels ✓ All reports acknowledged ✓ Timely investigations ✓ No retaliation", "HIGH", "Incident Mgmt"}
        };
        for (String[] ctrl : a6) items.add(new DetailedChecklistItem(ctrl[0], ctrl[1], ctrl[2], ctrl[3], ctrl[4], ctrl[5], ctrl[6], ctrl[7], ctrl[8]));

        // A.7 PHYSICAL CONTROLS (14)
        String[][] a7 = {
            {"A.7.1", "Physical security perimeters", "Security perimeters defined and used", "1. Define security zones 2. Implement perimeter barriers 3. Install access control 4. Deploy CCTV at entrances 5. Man reception desk 6. Display signage 7. Conduct inspections", "• Security zone maps • Perimeter barriers • Access control specs • CCTV coverage • Security desk procedures • Inspection logs", "1. Review zone definitions 2. Inspect barriers 3. Test access controls 4. Verify CCTV coverage 5. Check desk staffed 6. Review inspections 7. Validate perimeter integrity", "✓ Perimeters clearly defined ✓ Physical barriers in place ✓ Access controls operational ✓ CCTV covering all entry points ✓ Regular inspections conducted", "HIGH", "Physical Security"},
            {"A.7.2", "Physical entry", "Secure areas protected by entry controls", "1. Install card access 2. Implement visitor management 3. Require visitor escorts 4. Maintain visitor logs 5. Issue temporary badges 6. Restrict sensitive areas 7. Monitor entry points", "• Card access system • Visitor management system • Visitor logs • Temporary badge procedures • Restricted area access lists • Entry point monitoring logs", "1. Test card access system 2. Review visitor management process 3. Verify escort requirements followed 4. Check visitor log completeness 5. Sample restricted area access 6. Review monitoring effectiveness 7. Test emergency access procedures", "✓ Card access for all employees ✓ All visitors logged and escorted ✓ Restricted areas clearly marked ✓ Entry monitoring 24/7 ✓ Temporary access properly managed", "HIGH", "Physical Access"},
            {"A.7.3", "Securing offices and facilities", "Physical security for offices designed and implemented", "1. Implement secure office design 2. Control access to offices 3. Install security measures 4. Protect sensitive areas 5. Implement clean desk policy 6. Conduct security inspections", "• Office security design documentation • Access control for offices • Security measure implementation • Sensitive area protection • Clean desk policy • Inspection records", "1. Review office security design 2. Verify access controls 3. Check security measures 4. Review sensitive area protection 5. Test clean desk compliance 6. Review inspections", "✓ Offices securely designed ✓ Access controlled ✓ Security measures implemented ✓ Clean desk policy enforced", "MEDIUM", "Physical Security"},
            {"A.7.4", "Physical security monitoring", "Premises continuously monitored", "1. Install comprehensive CCTV 2. Implement 24/7 monitoring 3. Install intrusion detection 4. Configure motion sensors 5. Set up alarms 6. Retain recordings (90 days) 7. Integrate with SOC", "• CCTV documentation • 24/7 monitoring evidence • Intrusion detection specs • Alarm configuration • Recording retention policy • SOC integration", "1. Verify CCTV coverage 2. Test 24/7 monitoring 3. Check 90-day retention 4. Test intrusion detection 5. Verify alarms functional 6. Review monitoring logs 7. Test SOC integration", "✓ CCTV covers all critical areas ✓ 24/7 monitoring in place ✓ Recordings retained 90+ days ✓ Intrusion detection operational ✓ Alarms tested and functional", "HIGH", "Physical Monitoring"},
            {"A.7.5", "Protection against threats", "Protection against physical/environmental threats provided", "1. Assess environmental threats 2. Implement protection measures 3. Install fire suppression 4. Implement climate control 5. Protect against flooding 6. Implement power protection 7. Monitor environmental conditions", "• Threat assessment • Protection measures documentation • Fire suppression system • Climate control • Flood protection • UPS/generator • Environmental monitoring", "1. Review threat assessment 2. Verify protection measures 3. Test fire suppression 4. Check climate control 5. Review flood protection 6. Test power protection 7. Review environmental monitoring", "✓ Threats assessed ✓ Protection measures implemented ✓ Fire suppression tested ✓ Power protection in place", "HIGH", "Environmental Protection"},
            {"A.7.6", "Working in secure areas", "Security measures for secure areas implemented", "1. Define secure areas 2. Implement additional access controls 3. Restrict unauthorized access 4. Implement monitoring 5. Document secure area procedures", "• Secure area definitions • Additional access controls • Access restriction procedures • Monitoring implementation • Procedure documentation", "1. Review secure area definitions 2. Verify additional controls 3. Check access restrictions 4. Test monitoring 5. Review procedures", "✓ Secure areas defined ✓ Additional controls in place ✓ Access restricted ✓ Monitored continuously", "MEDIUM", "Physical Security"},
            {"A.7.7", "Clear desk and screen", "Clear desk and screen rules defined and enforced", "1. Develop clear desk policy 2. Require document locking 3. Implement auto screen lock (10 min) 4. Provide lockable storage 5. Conduct inspections 6. Enforce printer output collection 7. Implement privacy screens", "• Clear desk policy • Screen lock config (10 min) • Lockable storage provision • Inspection reports • Printer security • Privacy screen deployment", "1. Review policy 2. Test automatic screen lock 3. Inspect desks for compliance 4. Verify lockable storage available 5. Check printer output handling 6. Review inspection results 7. Test policy enforcement", "✓ Clear desk policy documented ✓ Automatic screen lock enforced ✓ Lockable storage for all ✓ Regular compliance checks ✓ Printer security measures in place", "MEDIUM", "Physical Security"},
            {"A.7.8", "Equipment siting and protection", "Equipment sited securely and protected", "1. Define equipment placement standards 2. Protect against environmental hazards 3. Implement cable management 4. Protect against theft 5. Restrict equipment access", "• Equipment placement standards • Environmental protection measures • Cable management • Anti-theft devices • Access restrictions", "1. Review placement standards 2. Check environmental protection 3. Verify cable management 4. Review anti-theft measures 5. Check access restrictions", "✓ Equipment properly sited ✓ Protected from environment ✓ Cables secured ✓ Anti-theft measures", "MEDIUM", "Equipment Security"},
            {"A.7.9", "Security of assets off-premises", "Off-site assets protected", "1. Encrypt all mobile devices 2. Require VPN for remote access 3. Implement remote wipe capability 4. Track equipment off-site 5. Require approval for off-site data 6. Implement anti-theft devices 7. Provide secure transport", "• Device encryption evidence • MDM system • Remote wipe capability • Off-site equipment tracking • Data removal approval records • Anti-theft device inventory • Secure transport procedures", "1. Verify all mobile devices encrypted 2. Test remote wipe capability 3. Review off-site equipment tracking 4. Check approval process 5. Validate MDM deployment 6. Test anti-theft devices 7. Review transport security", "✓ All mobile devices encrypted ✓ MDM deployed to all devices ✓ Remote wipe tested quarterly ✓ Off-site equipment tracked ✓ Secure transport for sensitive items", "HIGH", "Asset Protection"},
            {"A.7.10", "Storage media", "Storage media managed through lifecycle", "1. Classify storage media 2. Implement handling procedures 3. Secure media storage 4. Control media disposal 5. Track media inventory 6. Encrypt portable media", "• Media classification • Handling procedures • Secure storage facilities • Disposal procedures • Media inventory • Encryption evidence", "1. Review media classification 2. Check handling procedures 3. Verify secure storage 4. Test disposal procedures 5. Review media inventory 6. Verify portable media encrypted", "✓ Media classified ✓ Handling procedures in place ✓ Secure storage ✓ Secure disposal ✓ Portable media encrypted", "MEDIUM", "Media Mgmt"},
            {"A.7.11", "Supporting utilities", "Processing facilities protected from power failures", "1. Implement UPS systems 2. Install backup generators 3. Provide redundant power 4. Implement cooling redundancy 5. Monitor utility status 6. Test backup systems regularly", "• UPS implementation • Generator documentation • Redundant power systems • Cooling redundancy • Utility monitoring • Test results", "1. Verify UPS in place 2. Check generator capacity 3. Test redundant power 4. Review cooling redundancy 5. Verify monitoring 6. Review test results", "✓ UPS protecting critical systems ✓ Backup generator available ✓ Redundancy implemented ✓ Regular testing", "HIGH", "Infrastructure"},
            {"A.7.12", "Cabling security", "Cables protected from interception, interference, damage", "1. Install cable protection 2. Use conduits for sensitive cables 3. Label cables appropriately 4. Segregate power and data cables 5. Inspect cable installations", "• Cable protection documentation • Conduit installation • Cable labeling scheme • Cable segregation • Inspection records", "1. Review cable protection 2. Verify conduit usage 3. Check cable labeling 4. Verify segregation 5. Review inspections", "✓ Cables protected ✓ Conduits for sensitive cables ✓ Properly labeled ✓ Power/data segregated", "MEDIUM", "Cabling"},
            {"A.7.13", "Equipment maintenance", "Equipment maintained for availability, integrity, confidentiality", "1. Implement maintenance schedules 2. Use authorized personnel 3. Document all maintenance 4. Protect equipment during maintenance 5. Test after maintenance 6. Maintain maintenance logs", "• Maintenance schedules • Authorized personnel list • Maintenance documentation • Protection procedures during maintenance • Post-maintenance testing • Maintenance logs", "1. Review maintenance schedules 2. Verify authorized personnel 3. Sample maintenance records 4. Check protection procedures 5. Review post-maintenance testing 6. Audit maintenance logs", "✓ Regular maintenance scheduled ✓ Authorized personnel only ✓ All maintenance documented ✓ Post-maintenance testing", "MEDIUM", "Equipment Mgmt"},
            {"A.7.14", "Secure disposal of equipment", "Equipment disposal verified for data/software removal", "1. Implement disposal policy 2. Verify data removal 3. Use secure disposal methods 4. Obtain disposal certificates 5. Track disposed equipment 6. Remove software licenses", "• Disposal policy • Data removal verification • Disposal method documentation (shredding/degaussing) • Disposal certificates • Equipment disposal tracking • License removal records", "1. Review disposal policy 2. Verify data removal methods 3. Check disposal certificates 4. Review disposal tracking 5. Verify software license removal 6. Test disposal procedures", "✓ Disposal policy in place ✓ Data securely removed ✓ Disposal certificates obtained ✓ Equipment tracking ✓ Licenses removed", "HIGH", "Equipment Disposal"}
        };
        for (String[] ctrl : a6) items.add(new DetailedChecklistItem(ctrl[0], ctrl[1], ctrl[2], ctrl[3], ctrl[4], ctrl[5], ctrl[6], ctrl[7], ctrl[8]));

        // A.8 TECHNOLOGICAL CONTROLS (34)
        String[][] a8 = {
            {"A.8.1", "User endpoint devices", "Endpoint device information protected", "1. Implement EPP/EDR 2. Enforce disk encryption 3. Configure auto-updates 4. Implement app whitelisting 5. Enable firewall 6. Deploy patch management 7. Conduct vulnerability scans", "• EPP/EDR deployment • Disk encryption evidence • Auto-update config • Whitelist policies • Firewall rules • Patch reports • Vuln scan results", "1. Verify EPP/EDR on all 2. Check encryption status 3. Test auto-updates 4. Review whitelist 5. Verify firewall 6. Check patch compliance (95%+) 7. Review vuln findings", "✓ EPP/EDR on 100% endpoints ✓ All devices encrypted ✓ Auto-updates enabled ✓ Firewall active ✓ Patch compliance > 95%", "CRITICAL", "Endpoint Security"},
            {"A.8.2", "Privileged access rights", "Privileged access restricted and managed", "1. Identify privileged accounts 2. Implement PAM system 3. Require MFA for admin 4. Implement session recording 5. Review quarterly 6. Minimize privileged users 7. Implement JIT access 8. Monitor activity", "• Privileged account inventory • PAM system docs • MFA for admins • Session recordings • Quarterly reviews • JIT access implementation • Activity logs", "1. Review account inventory 2. Verify PAM in use 3. Test MFA on admin accounts 4. Check recordings functional 5. Verify quarterly reviews 6. Review privileged usage 7. Test JIT access 8. Analyze activity logs", "✓ All privileged accounts inventoried ✓ PAM deployed ✓ MFA for all privileged access ✓ Quarterly reviews performed ✓ Privileged activity monitored", "CRITICAL", "Privileged Access"},
            {"A.8.3", "Information access restriction", "Access restricted per topic-specific policy", "1. Define access restrictions 2. Implement need-to-know 3. Enforce least privilege 4. Implement access controls 5. Review access regularly 6. Audit access violations", "• Access restriction policy • Need-to-know implementation • Least privilege evidence • Access control systems • Access review records • Access violation audit", "1. Review access restriction policy 2. Verify need-to-know enforced 3. Test least privilege 4. Check access controls 5. Review access reviews 6. Audit violations", "✓ Access restrictions defined ✓ Need-to-know enforced ✓ Least privilege implemented ✓ Regular access reviews", "HIGH", "Access Control"},
            {"A.8.4", "Access to source code", "Source code access appropriately managed", "1. Restrict source code access 2. Implement version control 3. Protect source code repositories 4. Log all source code access 5. Review code access rights 6. Implement code signing", "• Source code access policy • Version control system • Repository protection • Access logs • Access rights review • Code signing implementation", "1. Review source code access policy 2. Verify restricted access 3. Check version control usage 4. Review access logs 5. Verify code signing 6. Test repository protection", "✓ Source code access restricted ✓ Version control in use ✓ All access logged ✓ Code signing implemented", "HIGH", "Development Security"},
            {"A.8.5", "Secure authentication", "Secure authentication implemented", "1. Implement MFA 2. Use FIDO2/WebAuthn 3. Enforce strong passwords 4. Implement SSO (OAuth/SAML) 5. Deploy certificate-based auth 6. Implement biometric for high-security 7. Monitor failures", "• MFA deployment • FIDO2 implementation • SSO configuration • Certificate infrastructure • Biometric systems • Failed auth logs", "1. Verify MFA enabled for all 2. Test FIDO2 3. Review SSO 4. Check certificates 5. Test biometric systems 6. Review failed auths 7. Validate password policy", "✓ MFA for all users ✓ Modern authentication protocols ✓ Failed attempts monitored ✓ Strong passwords enforced", "CRITICAL", "Authentication"},
            {"A.8.6", "Capacity management", "Resource use monitored and adjusted", "1. Monitor resource utilization 2. Forecast capacity needs 3. Plan capacity upgrades 4. Implement auto-scaling 5. Set capacity thresholds 6. Alert on capacity issues", "• Capacity monitoring tools • Utilization reports • Capacity forecasts • Upgrade plans • Auto-scaling configuration • Capacity alerts", "1. Review capacity monitoring 2. Check utilization reports 3. Verify forecasting process 4. Review upgrade plans 5. Test auto-scaling 6. Validate alerting", "✓ Capacity monitored continuously ✓ Forecasting in place ✓ Proactive capacity planning ✓ Alerts configured", "MEDIUM", "Capacity Mgmt"},
            {"A.8.7", "Protection against malware", "Malware protection implemented", "1. Deploy anti-malware 2. Enable real-time scanning 3. Configure auto-updates 4. Implement email filtering 5. Deploy web filtering 6. User awareness training 7. Regular scans 8. Monitor threats", "• Anti-malware deployment • Real-time protection • Signature update logs • Email filtering • Web filtering • Training records • Scan schedules • Threat detection logs", "1. Verify anti-malware 100% 2. Check real-time protection 3. Verify daily updates 4. Test email filtering 5. Review detections 6. Confirm training 7. Check scan compliance 8. Review response times", "✓ Anti-malware on 100% systems ✓ Real-time protection active ✓ Signatures updated daily ✓ Email/web filtering operational ✓ Users trained", "CRITICAL", "Malware Protection"},
            {"A.8.8", "Management of technical vulnerabilities", "Vulnerabilities obtained timely and addressed", "1. Subscribe to vulnerability feeds 2. Conduct monthly scans 3. Perform quarterly pen tests 4. Prioritize by CVSS 5. Patch critical within 30 days 6. Track remediation 7. Report to management monthly", "• Vulnerability feeds • Monthly scan reports • Quarterly pen test reports • CVSS prioritization • Patch records • Remediation tracking • Management reports", "1. Verify monthly scanning 2. Review pen test coverage 3. Check CVSS prioritization 4. Validate 30-day patching 5. Review patch rates (90%+) 6. Verify management reporting 7. Check exception approvals", "✓ Monthly vulnerability scans ✓ Quarterly penetration tests ✓ Critical patches within 30 days ✓ High patches within 90 days ✓ Management informed monthly", "CRITICAL", "Vulnerability Mgmt"},
            {"A.8.9", "Configuration management", "Configurations established, documented, monitored", "1. Implement CMDB 2. Develop secure baselines 3. Document standards 4. Implement IaC 5. Monitor drift 6. Review quarterly 7. Control changes", "• CMDB documentation • Secure baselines (CIS) • Configuration standards • IaC repository • Drift reports • Quarterly reviews • Change records", "1. Review CMDB 2. Verify baselines (CIS) 3. Test automation 4. Check drift detection 5. Verify quarterly reviews 6. Validate change control 7. Sample configurations", "✓ CMDB maintained and current ✓ Secure baselines for all systems ✓ Configuration drift monitored ✓ Quarterly reviews performed ✓ All config changes controlled", "CRITICAL", "Configuration Mgmt"},
            {"A.8.10", "Information deletion", "Information deleted when no longer required", "1. Define retention policy 2. Implement automated deletion 3. Verify deletion across all systems 4. Document deletion 5. Obtain deletion certificates 6. Consider legal holds", "• Retention policy • Automated deletion procedures • Deletion logs • Deletion certificates • Legal hold procedures", "1. Review retention policy 2. Test automated deletion 3. Verify deletion completeness 4. Review deletion logs 5. Check legal hold consideration", "✓ Retention policy defined ✓ Automated deletion in place ✓ Deletion verified ✓ Legal holds considered", "MEDIUM", "Data Lifecycle"},
            {"A.8.11", "Data masking", "Data masking used per policy", "1. Identify data requiring masking 2. Implement masking techniques 3. Apply masking to non-production 4. Document masking procedures 5. Test masked data 6. Review masking effectiveness", "• Data masking policy • Masking technique documentation • Non-production masking implementation • Masking procedures • Testing results • Effectiveness reviews", "1. Review masking policy 2. Verify masking techniques 3. Check non-production masking 4. Test masked data quality 5. Review effectiveness", "✓ Masking policy defined ✓ Masking implemented ✓ Non-production data masked ✓ Effectiveness verified", "MEDIUM", "Data Protection"},
            {"A.8.12", "Data leakage prevention", "DLP measures applied", "1. Implement DLP solution 2. Define DLP policies 3. Monitor data transfers 4. Block unauthorized transfers 5. Alert on policy violations 6. Review DLP incidents", "• DLP solution deployment • DLP policies • Monitoring configuration • Blocking rules • Alert configuration • Incident reports", "1. Verify DLP deployed 2. Review DLP policies 3. Test monitoring 4. Check blocking effectiveness 5. Review alerts 6. Audit incidents", "✓ DLP solution deployed ✓ Policies configured ✓ Monitoring active ✓ Violations blocked and alerted", "HIGH", "Data Loss Prevention"},
            {"A.8.13", "Information backup", "Backups maintained and tested", "1. Implement automated daily backups 2. Follow 3-2-1 rule 3. Encrypt backups (AES-256) 4. Test restores quarterly 5. Maintain offsite copies 6. Document procedures 7. Monitor success (99%+)", "• Backup policy • Backup schedule • Success/failure logs • Encryption evidence • Quarterly restore tests • Offsite agreements • Monitoring dashboards", "1. Review backup policy 2. Verify daily completion (99%+) 3. Test quarterly restores 4. Check encryption 5. Verify offsite copies 6. Review success rates 7. Validate 3-2-1 rule", "✓ Automated daily backups ✓ Encrypted ✓ Quarterly restore tests passed ✓ Offsite copies ✓ 3-2-1 rule followed ✓ Success rate > 99%", "CRITICAL", "Backup & Recovery"},
            {"A.8.14", "Redundancy", "Processing facilities implemented with redundancy", "1. Identify critical systems 2. Implement system redundancy 3. Implement network redundancy 4. Implement data redundancy 5. Test failover procedures 6. Document redundancy architecture", "• Redundancy architecture • Critical system identification • System redundancy implementation • Network redundancy • Data redundancy • Failover test results", "1. Review redundancy architecture 2. Verify critical systems identified 3. Test system failover 4. Test network failover 5. Verify data redundancy 6. Review test results", "✓ Redundancy for critical systems ✓ Failover tested ✓ Network redundancy in place ✓ Data replicated", "MEDIUM", "High Availability"},
            {"A.8.15", "Logging", "Logs produced, stored, protected and analyzed", "1. Enable logging on all systems 2. Log security events (auth, access, changes) 3. Centralize in SIEM 4. Protect log integrity 5. Retain 90+ days 6. Review daily 7. Alert on critical events 8. Maintain procedures", "• Logging policy • Log sources inventory • SIEM documentation • Log retention config • Integrity controls • Daily review reports • Security alerts • Log analysis procedures", "1. Verify logging on all systems 2. Check logs sent to SIEM 3. Validate log integrity protection 4. Verify 90-day retention 5. Review daily log analysis 6. Test security event alerts 7. Check log completeness 8. Validate time synchronization", "✓ Comprehensive logging enabled ✓ Logs centralized in SIEM ✓ Log integrity protected ✓ 90+ day retention ✓ Daily log review performed ✓ Alerts for critical events", "CRITICAL", "Logging & Monitoring"},
            {"A.8.16", "Monitoring activities", "Systems monitored for anomalous behaviour", "1. Deploy SIEM 2. Configure behavioral analytics 3. Establish baselines 4. Set up anomaly detection 5. Create automated alerts 6. Implement 24/7 SOC 7. Define escalation", "• SIEM deployment • Behavioral analytics • Baseline documentation • Anomaly detection rules • Alert configuration • SOC procedures • Escalation matrix", "1. Verify SIEM operational 2. Test anomaly detection 3. Review baselines 4. Validate alerting 5. Check SOC response times 6. Review escalation 7. Test detection effectiveness", "✓ SIEM monitoring critical systems ✓ Anomaly detection configured ✓ 24/7 SOC monitoring ✓ Alerts trigger response ✓ Mean time to detect < 1 hour", "CRITICAL", "Security Monitoring"},
            {"A.8.17", "Clock synchronization", "Clocks synchronized to approved time sources", "1. Implement NTP servers 2. Configure all systems to sync 3. Use authoritative time sources 4. Monitor time synchronization 5. Alert on time drift 6. Document time source", "• NTP server implementation • Time synchronization configuration • Authoritative time sources • Monitoring procedures • Time drift alerts • Time source documentation", "1. Verify NTP servers deployed 2. Check all systems configured to sync 3. Verify time sources authoritative 4. Test synchronization 5. Review time drift monitoring 6. Validate alerting", "✓ NTP servers deployed ✓ All systems synchronized ✓ Authoritative time sources used ✓ Time drift monitored and alerted", "MEDIUM", "System Operations"},
            {"A.8.18", "Privileged utility programs", "Utility programs restricted and controlled", "1. Identify privileged utilities 2. Restrict access to utilities 3. Log all utility usage 4. Review utility access 5. Implement approval process 6. Monitor for misuse", "• Privileged utility inventory • Access restrictions • Utility usage logs • Access review records • Approval procedures • Misuse monitoring", "1. Review utility inventory 2. Verify access restrictions 3. Check logging of usage 4. Review access rights 5. Test approval process 6. Review misuse monitoring", "✓ Utilities identified and restricted ✓ All usage logged ✓ Access reviewed regularly ✓ Misuse monitored", "HIGH", "System Security"},
            {"A.8.19", "Software installation", "Software installation securely managed", "1. Define software installation policy 2. Implement change control for software 3. Test software before installation 4. Use approved software sources 5. Log all installations 6. Remove unauthorized software", "• Software installation policy • Change control procedures • Software testing procedures • Approved software sources • Installation logs • Software audit results", "1. Review installation policy 2. Verify change control 3. Check software testing 4. Validate approved sources 5. Review installation logs 6. Audit for unauthorized software", "✓ Installation policy in place ✓ Change control enforced ✓ Software tested before install ✓ Only approved sources used ✓ No unauthorized software", "HIGH", "Software Mgmt"},
            {"A.8.20", "Networks security", "Networks and devices secured, managed and controlled", "1. Implement network segmentation 2. Deploy firewalls 3. Implement IDS/IPS 4. Configure network access controls 5. Monitor network traffic 6. Document network architecture 7. Conduct network security assessments", "• Network architecture documentation • Network segmentation • Firewall configuration • IDS/IPS deployment • Network access controls • Traffic monitoring • Security assessment reports", "1. Review network architecture 2. Verify network segmentation 3. Test firewalls 4. Check IDS/IPS effectiveness 5. Review network access controls 6. Verify traffic monitoring 7. Review security assessments", "✓ Network segmented ✓ Firewalls deployed and configured ✓ IDS/IPS active ✓ Network access controlled ✓ Traffic monitored ✓ Regular security assessments", "CRITICAL", "Network Security"},
            {"A.8.21", "Security of network services", "Network service security mechanisms implemented", "1. Identify all network services 2. Define security requirements 3. Implement service-level agreements 4. Monitor service security 5. Review service security regularly 6. Document service security", "• Network service inventory • Security requirements for services • SLAs with security terms • Service monitoring • Service security reviews • Service security documentation", "1. Review service inventory 2. Verify security requirements defined 3. Check SLAs include security 4. Review service monitoring 5. Verify regular security reviews 6. Validate documentation", "✓ All network services identified ✓ Security requirements defined ✓ SLAs include security ✓ Services monitored ✓ Regular reviews", "HIGH", "Network Services"},
            {"A.8.22", "Segregation of networks", "Groups of services/users/systems segregated", "1. Implement network segmentation 2. Separate production/non-production 3. Isolate sensitive systems 4. Use VLANs 5. Implement firewall rules 6. Monitor inter-segment traffic", "• Network segmentation design • Production/non-production separation • Sensitive system isolation • VLAN configuration • Firewall rules • Traffic monitoring", "1. Review segmentation design 2. Verify prod/non-prod separation 3. Check sensitive system isolation 4. Test VLAN configuration 5. Review firewall rules 6. Verify traffic monitoring", "✓ Network segmented ✓ Production isolated ✓ Sensitive systems isolated ✓ Firewall rules enforced ✓ Traffic monitored", "HIGH", "Network Segmentation"},
            {"A.8.23", "Web filtering", "Access to external websites managed", "1. Implement web filtering solution 2. Define acceptable use policy 3. Block malicious categories 4. Log web access 5. Monitor for policy violations 6. Review filtering effectiveness", "• Web filtering solution • Acceptable use policy • Blocked categories list • Web access logs • Policy violation reports • Filtering effectiveness reviews", "1. Verify web filtering deployed 2. Review acceptable use policy 3. Check malicious categories blocked 4. Review access logs 5. Verify violation monitoring 6. Test filtering effectiveness", "✓ Web filtering deployed ✓ Malicious sites blocked ✓ All access logged ✓ Violations monitored ✓ Regular effectiveness reviews", "MEDIUM", "Web Security"},
            {"A.8.24", "Use of cryptography", "Cryptography rules defined and implemented", "1. Develop cryptographic policy 2. Implement AES-256 for data at rest 3. Enforce TLS 1.3 for transit 4. Use RSA-2048/ECC-256 5. Implement HSM for keys 6. Rotate keys quarterly 7. Document all crypto 8. Prohibit weak algorithms", "• Cryptographic policy • Encryption algorithm inventory (AES-256, TLS 1.3) • HSM implementation • Key management procedures • Key rotation logs • Crypto configuration files • Algorithm prohibition list • Vendor certificates", "1. Review cryptographic policy 2. Verify AES-256 for databases 3. Test TLS 1.3 enforcement 4. Check HSM usage 5. Verify quarterly key rotation 6. Scan for prohibited algorithms 7. Test encryption during transmission 8. Review key management procedures", "✓ AES-256 for all data at rest ✓ TLS 1.3 enforced for all connections ✓ HSM for production keys ✓ Quarterly key rotation ✓ No weak algorithms in use ✓ All cryptography documented", "CRITICAL", "Cryptography"},
            {"A.8.25", "Secure development lifecycle", "Secure development rules established", "1. Define SDLC policy 2. Implement security requirements phase 3. Conduct threat modeling 4. Perform security testing 5. Conduct code reviews 6. Implement security gates 7. Document security decisions", "• SDLC policy • Security requirements documentation • Threat models • Security test results • Code review records • Security gate checklists • Security decision documentation", "1. Review SDLC policy 2. Verify security requirements phase 3. Check threat modeling 4. Review security testing 5. Verify code reviews 6. Test security gates 7. Review security decisions", "✓ SDLC policy includes security ✓ Security requirements defined ✓ Threat modeling performed ✓ Security testing mandatory ✓ Security gates enforced", "HIGH", "Secure Development"},
            {"A.8.26", "Application security requirements", "Security requirements identified when developing/acquiring apps", "1. Define application security standards 2. Identify security requirements 3. Include in RFPs/contracts 4. Validate security before deployment 5. Conduct security assessments 6. Document security requirements", "• Application security standards • Security requirements documentation • RFP/contract security terms • Pre-deployment security validation • Security assessment reports • Requirements documentation", "1. Review application security standards 2. Verify requirements identified 3. Check RFP/contract terms 4. Test pre-deployment validation 5. Review security assessments 6. Validate documentation", "✓ Security standards defined ✓ Requirements identified for all apps ✓ Pre-deployment validation ✓ Security assessments conducted", "HIGH", "Application Security"},
            {"A.8.27", "Secure system architecture", "Secure architecture principles established", "1. Define architecture principles 2. Implement defense in depth 3. Use secure design patterns 4. Implement security controls by design 5. Review architecture regularly 6. Document architecture decisions", "• Architecture principles • Defense in depth implementation • Secure design patterns • Security controls architecture • Architecture reviews • Architecture decision records", "1. Review architecture principles 2. Verify defense in depth 3. Check secure design patterns 4. Review security controls 5. Verify regular reviews 6. Review architecture decisions", "✓ Architecture principles defined ✓ Defense in depth implemented ✓ Secure patterns used ✓ Regular architecture reviews", "HIGH", "System Architecture"},
            {"A.8.28", "Secure coding", "Secure coding principles applied", "1. Define secure coding standards 2. Train developers 3. Implement code analysis tools (SAST) 4. Conduct code reviews 5. Fix security vulnerabilities 6. Document coding practices", "• Secure coding standards • Developer training records • SAST tool implementation • Code review records • Vulnerability fix documentation • Coding practice documentation", "1. Review coding standards 2. Verify developer training 3. Check SAST tool usage 4. Review code reviews 5. Verify vulnerability remediation 6. Validate documentation", "✓ Secure coding standards defined ✓ Developers trained ✓ SAST tools in use ✓ Code reviews mandatory ✓ Vulnerabilities remediated", "HIGH", "Secure Coding"},
            {"A.8.29", "Security testing", "Security testing in development lifecycle", "1. Define security testing requirements 2. Conduct SAST (static analysis) 3. Conduct DAST (dynamic analysis) 4. Perform penetration testing 5. Conduct dependency scanning 6. Fix all critical findings before release", "• Security testing policy • SAST results • DAST results • Penetration test reports • Dependency scan results • Critical finding remediation records", "1. Review testing policy 2. Verify SAST performed 3. Check DAST performed 4. Review pen test results 5. Verify dependency scanning 6. Validate critical findings fixed", "✓ Security testing required ✓ SAST and DAST performed ✓ Penetration testing conducted ✓ All critical findings remediated before release", "HIGH", "Security Testing"},
            {"A.8.30", "Outsourced development", "Outsourced development directed and monitored", "1. Define outsourcing security requirements 2. Include security in contracts 3. Monitor outsourced development 4. Conduct security reviews 5. Require code security testing 6. Validate deliverables", "• Outsourcing security requirements • Contract security terms • Monitoring procedures • Security review records • Code security test results • Deliverable validation records", "1. Review outsourcing requirements 2. Verify contract security terms 3. Check monitoring procedures 4. Review security reviews 5. Verify code testing 6. Validate deliverables", "✓ Security requirements in outsourcing contracts ✓ Development monitored ✓ Security reviews conducted ✓ Code tested ✓ Deliverables validated", "MEDIUM", "Outsourcing Security"},
            {"A.8.31", "Separation of environments", "Dev, test and production environments separated", "1. Implement environment separation 2. Use different credentials 3. Restrict production access 4. Implement data masking for non-prod 5. Monitor environment access 6. Prohibit production changes without approval", "• Environment separation documentation • Credential separation • Production access restrictions • Data masking in non-production • Environment access logs • Change control for production", "1. Verify environment separation 2. Check credential separation 3. Test production access restrictions 4. Verify data masking 5. Review access logs 6. Test change control", "✓ Environments clearly separated ✓ Different credentials ✓ Production access restricted ✓ Non-prod data masked ✓ Change control enforced", "HIGH", "Environment Mgmt"},
            {"A.8.32", "Change management", "Changes subject to change management procedures", "1. Implement change management process 2. Require change approvals 3. Test all changes 4. Implement rollback procedures 5. Document all changes 6. Review changes post-implementation", "• Change management procedures • Change approval records • Change testing results • Rollback procedures • Change documentation • Post-implementation reviews", "1. Review change procedures 2. Verify approvals required 3. Check testing performed 4. Test rollback capability 5. Review change documentation 6. Verify post-implementation reviews", "✓ Change management process in place ✓ All changes approved ✓ Testing required ✓ Rollback procedures documented ✓ Changes documented", "HIGH", "Change Mgmt"},
            {"A.8.33", "Test information", "Test information selected, protected and managed", "1. Define test data policy 2. Use production-like test data 3. Mask sensitive data 4. Protect test data 5. Delete test data after use 6. Monitor test data usage", "• Test data policy • Test data selection procedures • Data masking procedures • Test data protection • Data deletion procedures • Usage monitoring", "1. Review test data policy 2. Verify masking procedures 3. Check data protection 4. Test deletion procedures 5. Review usage monitoring", "✓ Test data policy defined ✓ Sensitive data masked ✓ Test data protected ✓ Deleted after use", "MEDIUM", "Test Data Mgmt"},
            {"A.8.34", "Protection during audit testing", "Audit tests planned and agreed", "1. Plan audit tests 2. Obtain management approval 3. Minimize impact on operations 4. Protect systems during testing 5. Monitor testing activities 6. Review test results with management", "• Audit test plans • Management approval records • Impact minimization procedures • System protection during testing • Testing activity monitoring • Test result reviews", "1. Review test plans 2. Verify management approval 3. Check impact minimization 4. Review system protection 5. Verify monitoring 6. Validate result review", "✓ Audit tests planned ✓ Management approved ✓ Minimal operational impact ✓ Systems protected ✓ Results reviewed", "MEDIUM", "Audit Testing"}
        };
        for (String[] ctrl : a8) items.add(new DetailedChecklistItem(ctrl[0], ctrl[1], ctrl[2], ctrl[3], ctrl[4], ctrl[5], ctrl[6], ctrl[7], ctrl[8]));

        log.info("✅ Generated {} complete ISO 27001:2022 controls", items.size());
        return items;
    }

    // GDPR - ALL KEY ARTICLES (50+)
    private List<DetailedChecklistItem> getGDPRCompleteChecklist() {
        List<DetailedChecklistItem> items = new ArrayList<>();
        
        String[][] gdpr = {
            {"Art. 5(1)(a)", "Lawfulness, fairness, transparency", "Personal data processed lawfully, fairly and transparently", "1. Establish legal basis 2. Document in processing records 3. Provide privacy notices 4. Implement fair processing 5. Make processing transparent 6. Review when purposes change", "• Legal basis documentation • Privacy notices • Consent records • Legitimate Interest Assessments • Contract terms • Article 30 records", "1. Review Article 30 records for legal basis 2. Verify privacy notices clear 3. Check consent GDPR-compliant 4. Review LIAs 5. Test transparency 6. Validate processing against purposes", "✓ Valid legal basis for all processing ✓ Privacy notices at collection ✓ Consent obtained where required ✓ Processing transparent ✓ Legal basis documented", "CRITICAL", "Principles"},
            {"Art. 5(1)(b)", "Purpose limitation", "Data collected for specified, explicit, legitimate purposes", "1. Document specific purposes 2. Communicate in privacy notices 3. Implement purpose checking 4. Conduct compatibility assessment 5. Obtain new consent if purposes change 6. Restrict access by purpose", "• Purpose documentation • Privacy notice purpose statements • Purpose change assessments • New consent records • Access restrictions by purpose • Purpose review records", "1. Review purposes in Article 30 records 2. Verify purposes in privacy notices 3. Check data used only for stated purposes 4. Review purpose change process 5. Sample processing 6. Test access controls", "✓ All purposes documented ✓ Communicated to data subjects ✓ No processing beyond original purposes ✓ Purpose change process established", "CRITICAL", "Principles"},
            {"Art. 5(1)(c)", "Data minimisation", "Data adequate, relevant, limited to necessary", "1. Review all data collection 2. Eliminate unnecessary data 3. Collect only what's needed 4. Implement data minimization checks 5. Review regularly 6. Delete unnecessary data", "• Data minimization policy • Data collection review records • Minimization check procedures • Regular review schedule • Data deletion logs", "1. Review minimization policy 2. Verify minimization checks 3. Sample data collection 4. Check regular reviews 5. Verify unnecessary data deleted", "✓ Only necessary data collected ✓ Regular minimization reviews ✓ Unnecessary data deleted", "HIGH", "Principles"},
            {"Art. 5(1)(d)", "Accuracy", "Personal data accurate and kept up to date", "1. Implement data quality procedures 2. Provide data update mechanisms 3. Verify data accuracy regularly 4. Delete/rectify inaccurate data 5. Monitor data quality metrics", "• Data quality procedures • Data update mechanisms • Accuracy verification procedures • Inaccurate data handling • Data quality metrics", "1. Review quality procedures 2. Test update mechanisms 3. Verify accuracy checks 4. Review inaccurate data handling 5. Check quality metrics", "✓ Data quality procedures in place ✓ Update mechanisms available ✓ Regular accuracy checks ✓ Inaccurate data rectified", "HIGH", "Principles"},
            {"Art. 5(1)(e)", "Storage limitation", "Data kept no longer than necessary", "1. Define retention periods 2. Implement automated deletion 3. Document retention schedule 4. Review retention periods 5. Delete data when retention expires 6. Consider legal holds", "• Retention policy and schedule • Automated deletion procedures • Deletion logs • Retention review records • Legal hold procedures", "1. Review retention policy 2. Verify retention periods defined 3. Test automated deletion 4. Check deletion logs 5. Verify legal holds considered", "✓ Retention periods defined ✓ Automated deletion in place ✓ Data deleted when no longer needed ✓ Legal holds managed", "HIGH", "Principles"},
            {"Art. 5(1)(f)", "Integrity and confidentiality", "Data processed ensuring appropriate security", "1. Conduct risk assessment 2. Implement encryption (AES-256, TLS 1.3) 3. Implement access controls 4. Protect against unauthorized processing 5. Test security measures 6. Document security", "• Risk assessments • Encryption implementation • Access controls • Unauthorized processing protection • Security testing results • Security documentation", "1. Review risk assessments 2. Verify encryption at rest and transit 3. Test access controls 4. Review protection measures 5. Verify regular testing 6. Validate documentation", "✓ Risk-based security ✓ Encryption implemented ✓ Access controlled ✓ Regular testing ✓ Security documented", "CRITICAL", "Principles"},
            {"Art. 6", "Lawfulness of processing", "Processing lawful only if legal basis applies", "1. Identify legal basis for each activity 2. Document in Article 30 records 3. Obtain valid consent where used 4. Conduct legitimate interest assessments 5. Review when processing changes 6. Communicate in privacy notice", "• Legal basis documentation matrix • Consent records • Legitimate Interest Assessments • Article 30 processing records • Privacy notice legal basis statements • Legal basis review records", "1. Review all processing for legal basis 2. Verify consent is GDPR-compliant 3. Check LIAs for legitimate interests 4. Validate Article 30 records complete 5. Confirm privacy notices accurate 6. Test consent withdrawal mechanism", "✓ Valid legal basis for all processing ✓ Legal basis documented ✓ Consent properly obtained ✓ LIAs completed for legitimate interests", "CRITICAL", "Legal Basis"},
            {"Art. 7", "Conditions for consent", "Controller must demonstrate consent was given", "1. Implement consent management 2. Use clear consent language 3. Separate consent from other terms 4. Provide withdrawal mechanism 5. Document all consents 6. Review consent validity", "• Consent management system • Consent records • Consent language examples • Withdrawal mechanism • Consent audit trail", "1. Review consent mechanisms 2. Check language is clear 3. Verify consent separate 4. Test withdrawal 5. Review consent records 6. Validate audit trail", "✓ Valid consent obtained ✓ Clear language used ✓ Withdrawal available ✓ All consents documented ✓ Audit trail maintained", "HIGH", "Consent"},
            {"Art. 13", "Information provided at collection", "Controller provides information including identity, purposes, legal basis", "1. Create privacy notices 2. Include all required info 3. Provide at collection point 4. Use clear language 5. Make easily accessible 6. Update when changes occur", "• Privacy notices • Notice templates • Collection point evidence • Language simplicity testing • Accessibility evidence • Update records", "1. Review privacy notices 2. Check all required info included 3. Verify provided at collection 4. Test language clarity 5. Verify accessibility 6. Check update frequency", "✓ Privacy notices at all collection points ✓ All required information included ✓ Clear and accessible language ✓ Updated when processing changes", "HIGH", "Transparency"},
            {"Art. 15", "Right of access", "Data subject has right to confirmation and access", "1. Establish DSAR process 2. Create DSAR response template 3. Verify identity of requesters 4. Respond within 1 month 5. Provide data in accessible format 6. Include all required information 7. Log all DSARs", "• DSAR procedures • DSAR request forms • Identity verification process • DSAR response templates • DSAR tracking log • Response time metrics • Data format specifications", "1. Review DSAR process documented 2. Test identity verification 3. Verify 1-month response timeline met 4. Check responses include all required info 5. Review DSAR log completeness 6. Validate data format accessibility 7. Test process end-to-end", "✓ DSAR process documented ✓ Responses within 1 month (100%) ✓ All required information provided ✓ Identity verification implemented", "HIGH", "Data Subject Rights"},
            {"Art. 16", "Right to rectification", "Data subject has right to rectify inaccurate data", "1. Establish rectification process 2. Verify identity of requesters 3. Verify accuracy of data 4. Rectify inaccurate data 5. Notify recipients of rectification 6. Respond within 1 month 7. Log all rectification requests", "• Rectification procedures • Identity verification • Data accuracy verification • Rectification logs • Recipient notification records • Response time tracking • Rectification request log", "1. Review rectification process 2. Test identity verification 3. Verify accuracy verification process 4. Check rectification timeliness 5. Verify recipients notified 6. Review response times 7. Audit rectification log", "✓ Rectification process documented ✓ Identity verification in place ✓ Inaccurate data rectified ✓ Recipients notified ✓ Responses within 1 month", "MEDIUM", "Data Subject Rights"},
            {"Art. 17", "Right to erasure", "Data subject has right to erasure", "1. Implement deletion procedures 2. Define erasure timeframes 3. Create erasure request forms 4. Verify deletion across all systems 5. Document deletion completion 6. Consider legal retention 7. Notify third parties", "• Data deletion procedures • Erasure request forms • Deletion logs and certificates • System purge documentation • Legal hold procedures • Third-party notification records • Retention schedule", "1. Review deletion procedures 2. Test deletion across systems 3. Verify retention requirements considered 4. Check deletion certificate provided 5. Confirm third parties notified 6. Review deletion completeness 7. Test technical deletion capability", "✓ Deletion procedures documented ✓ Erasure across all systems ✓ Retention requirements respected ✓ Third parties notified ✓ Deletion certificates provided", "HIGH", "Data Subject Rights"},
            {"Art. 18", "Right to restriction", "Data subject has right to restrict processing", "1. Establish restriction process 2. Implement restriction mechanisms 3. Mark restricted data 4. Notify recipients of restriction 5. Inform data subject before lifting restriction 6. Respond within 1 month", "• Restriction procedures • Restriction mechanisms • Data marking procedures • Recipient notification • Data subject notification • Response time tracking", "1. Review restriction process 2. Test restriction mechanisms 3. Verify data marking 4. Check recipient notification 5. Verify data subject notification 6. Review response times", "✓ Restriction process documented ✓ Restriction mechanisms in place ✓ Recipients notified ✓ Data subject informed ✓ Responses within 1 month", "MEDIUM", "Data Subject Rights"},
            {"Art. 20", "Right to data portability", "Data subject has right to receive data in portable format", "1. Establish portability process 2. Determine applicable data 3. Implement data export 4. Use structured format (JSON/XML) 5. Provide machine-readable format 6. Respond within 1 month", "• Portability procedures • Data export functionality • Format specifications (JSON/XML) • Response time tracking • Portability request log", "1. Review portability process 2. Test data export functionality 3. Verify structured format used 4. Check machine-readability 5. Review response times 6. Audit portability requests", "✓ Portability process documented ✓ Data export available ✓ Structured, machine-readable format ✓ Responses within 1 month", "MEDIUM", "Data Subject Rights"},
            {"Art. 25", "Data protection by design and default", "Privacy implemented from design and by default", "1. Integrate privacy from project start 2. Implement privacy by default 3. Use pseudonymization 4. Minimize data collection 5. Limit processing purposes 6. Implement access controls 7. Document privacy measures", "• Privacy by design procedures • Project security integration • Pseudonymization implementation • Data minimization evidence • Purpose limitation controls • Access control matrix • Privacy measure documentation", "1. Review privacy integration in projects 2. Verify privacy by default settings 3. Check pseudonymization where applicable 4. Validate data minimization 5. Review purpose limitations 6. Test access controls 7. Verify documentation", "✓ Privacy considered from design phase ✓ Privacy by default implemented ✓ Data minimized ✓ Purpose limitation enforced ✓ Privacy measures documented", "CRITICAL", "Privacy by Design"},
            {"Art. 28", "Processor requirements", "Controller uses only processors providing sufficient guarantees", "1. Assess processor capabilities 2. Execute data processing agreements 3. Include all required clauses 4. Specify processing instructions 5. Require breach notification 6. Include audit rights 7. Monitor processor compliance", "• Processor assessment • Data Processing Agreements (DPAs) • DPA templates with required clauses • Processing instructions • Breach notification procedures • Audit rights documentation • Processor compliance monitoring", "1. Review processor selection process 2. Verify DPAs executed 3. Check required clauses included 4. Validate processing instructions clear 5. Confirm breach notification clause 6. Verify audit rights 7. Review compliance monitoring", "✓ All processors assessed ✓ DPAs with all processors ✓ All required clauses included ✓ Processor compliance monitored", "CRITICAL", "Processor Mgmt"},
            {"Art. 30", "Records of processing", "Controller maintains processing activity records", "1. Create comprehensive processing inventory 2. Document: purposes, data categories, recipients, transfers, retention, security measures 3. Update when processing changes 4. Make available to supervisory authority 5. Review and update annually 6. Assign responsibility", "• Article 30 processing records • Processing activity inventory • Data flow diagrams • Cross-border transfer documentation • Retention schedules • Security measures documentation • Annual review records", "1. Verify records exist for all processing 2. Check all required fields completed 3. Review accuracy of purposes 4. Validate data categories accurate 5. Confirm retention periods defined 6. Verify annual updates 7. Test supervisory authority access", "✓ Complete processing inventory maintained ✓ All required fields documented ✓ Records updated annually ✓ Available to supervisory authority", "CRITICAL", "Accountability"},
            {"Art. 32", "Security of processing", "Appropriate security measures implemented", "1. Conduct risk assessment for all processing 2. Implement encryption (AES-256, TLS 1.3) 3. Implement pseudonymization 4. Ensure confidentiality, integrity, availability, resilience 5. Implement regular testing 6. Document all security measures", "• Risk assessments • Encryption implementation • Pseudonymization procedures • Security controls inventory • Penetration test reports • Vulnerability scans • Security testing schedules • BC/DR plans", "1. Review risk assessments 2. Verify encryption at rest (AES-256) 3. Test TLS implementation (TLS 1.3) 4. Check pseudonymization 5. Review backup/recovery 6. Verify regular security testing 7. Assess resilience 8. Test incident response", "✓ Risk-based security measures ✓ Encryption for all personal data ✓ Regular security testing (quarterly) ✓ Backup/recovery tested annually ✓ Security measures reviewed ✓ Incident response documented", "CRITICAL", "Security"},
            {"Art. 33", "Breach notification to authority", "Controller notifies supervisory authority within 72 hours", "1. Implement breach detection 2. Establish 72-hour notification procedures 3. Create breach templates 4. Define breach severity assessment 5. Maintain breach register 6. Designate breach response team 7. Establish supervisory authority contact", "• Breach detection tools • Breach notification procedures • Breach templates • Breach severity matrix • Breach register • Breach response team • Supervisory authority notification records • 72-hour timeline documentation", "1. Review breach detection capabilities 2. Verify breach response procedures 3. Check breach register 4. Validate 72-hour timeline compliance 5. Review notifications sent 6. Test breach response team 7. Verify breach assessment criteria 8. Check notification completeness", "✓ Breach detection mechanisms ✓ 72-hour notification procedure ✓ Breach register maintained ✓ All notifiable breaches reported within 72 hours ✓ Response team trained", "CRITICAL", "Breach Mgmt"},
            {"Art. 34", "Breach communication to data subject", "Controller communicates breach to data subject when high risk", "1. Define high risk criteria 2. Create data subject notification templates 3. Determine notification timing 4. Describe breach and consequences 5. Describe measures taken 6. Provide contact point 7. Log all notifications", "• High risk criteria • Data subject notification templates • Notification procedures • Breach description documentation • Measures taken documentation • Contact point information • Notification log", "1. Review high risk criteria 2. Verify notification templates 3. Check notification timing appropriate 4. Review breach descriptions 5. Verify measures communicated 6. Confirm contact point provided 7. Audit notification log", "✓ High risk criteria defined ✓ Data subjects notified when high risk ✓ Clear breach descriptions ✓ Measures taken communicated ✓ All notifications logged", "HIGH", "Breach Mgmt"},
            {"Art. 35", "Data protection impact assessment", "DPIA conducted for high-risk processing", "1. Identify high-risk processing 2. Use DPIA template 3. Describe processing operations 4. Assess necessity and proportionality 5. Assess risks to data subjects 6. Identify mitigation measures 7. Consult DPO 8. Update DPIAs when processing changes", "• DPIA policy and threshold criteria • Completed DPIA documents • Risk assessment within DPIA • Mitigation measures documentation • DPO consultation records • DPIA review and update schedule • Prior consultation evidence (if required)", "1. Verify DPIA threshold criteria 2. Check DPIAs for high-risk processing 3. Review DPIA completeness 4. Validate risk assessment thorough 5. Confirm mitigation implemented 6. Verify DPO consulted 7. Check DPIA updates when changes", "✓ DPIA criteria established ✓ DPIAs for all high-risk processing ✓ Risks properly assessed ✓ Mitigation implemented ✓ DPO consulted", "CRITICAL", "Privacy Impact"},
            {"Art. 37", "Data protection officer", "DPO designated where required", "1. Determine if DPO required 2. Designate qualified DPO 3. Publish DPO contact details 4. Provide DPO with resources 5. Ensure DPO independence 6. Involve DPO in all data protection issues 7. Report DPO to supervisory authority", "• DPO designation decision • DPO appointment letter • DPO qualifications and training • DPO contact information (public) • DPO resource allocation • DPO involvement evidence • Supervisory authority notification", "1. Review DPO requirement assessment 2. Verify DPO qualifications adequate 3. Check DPO contact details published 4. Confirm DPO has necessary resources 5. Verify DPO independence 6. Review DPO involvement in decisions 7. Confirm reported to authority", "✓ DPO designated if required ✓ DPO properly qualified ✓ Contact details published ✓ DPO independence ensured ✓ DPO involved in all data protection matters", "HIGH", "DPO"}
        };
        for (String[] art : gdpr) items.add(new DetailedChecklistItem(art[0], art[1], art[2], art[3], art[4], art[5], art[6], art[7], art[8]));

        log.info("✅ Generated {} complete GDPR articles", items.size());
        return items;
    }

    // HIPAA - ALL REQUIREMENTS (60+)
    private List<DetailedChecklistItem> getHIPAACompleteChecklist() {
        List<DetailedChecklistItem> items = new ArrayList<>();
        
        String[][] hipaa = {
            {"§164.308(a)(1)(i)", "Security Management Process", "Prevent, detect, contain, correct security violations", "1. Develop security management framework 2. Establish prevention controls 3. Implement monitoring/detection 4. Create containment procedures 5. Develop corrective action processes 6. Document activities 7. Conduct regular reviews", "• Security framework • Prevention control inventory • Monitoring system docs • Containment procedures • Corrective action logs • Management review minutes • Security metrics", "1. Review framework 2. Verify prevention controls 3. Test detection systems 4. Review containment 5. Check corrective actions 6. Verify quarterly reviews 7. Assess program effectiveness", "✓ Security program documented ✓ Prevention, detection, containment, correction addressed ✓ Regular reviews ✓ Violations tracked", "CRITICAL", "Administrative"},
            {"§164.308(a)(1)(ii)(A)", "Risk Analysis (R)", "Conduct accurate risk assessment of ePHI risks", "1. Identify all ePHI (data mapping) 2. Identify all threats 3. Identify vulnerabilities 4. Assess current security measures 5. Determine likelihood of threats 6. Determine potential impact 7. Calculate risk levels 8. Prioritize risks 9. Document findings 10. Update annually", "• ePHI inventory • Threat identification • Vulnerability assessment reports • Security controls inventory • Risk assessment matrix • Risk register • Risk analysis report • Annual schedule • Change-triggered assessments", "1. Verify ePHI inventory complete 2. Check threat identification comprehensive 3. Review vulnerability assessments 4. Validate risk calculations 5. Confirm annual analysis 6. Verify changes trigger new analysis 7. Check risk prioritization 8. Review remediation plans", "✓ Complete ePHI inventory ✓ All threats/vulnerabilities identified ✓ Risk analysis within 12 months ✓ Risk levels calculated ✓ High risks have remediation plans ✓ Methodology documented", "CRITICAL", "Risk Mgmt"},
            {"§164.308(a)(1)(ii)(B)", "Risk Management (R)", "Reduce risks to reasonable and appropriate level", "1. Develop risk treatment plan 2. Implement controls to mitigate high risks 3. Document acceptance of residual risks 4. Allocate resources 5. Track remediation progress 6. Reassess risks after controls 7. Report risk status to management", "• Risk treatment plans • Implemented controls documentation • Residual risk acceptance (signed by management) • Risk mitigation budget • Risk remediation tracking reports • Post-implementation risk assessments • Management risk reports (quarterly)", "1. Review risk treatment plans 2. Verify controls implemented for high risks 3. Check management signed off residual risks 4. Validate adequate resources 5. Review remediation tracking 6. Confirm post-implementation assessments 7. Verify regular management reporting", "✓ All high/critical risks have treatment plans ✓ Security controls implemented ✓ Residual risks accepted by management ✓ Risk management ongoing ✓ Risks reduced to reasonable level", "CRITICAL", "Risk Mgmt"},
            {"§164.308(a)(1)(ii)(C)", "Sanction Policy (R)", "Apply sanctions against violations", "1. Develop sanction policy 2. Define violation categories 3. Specify sanctions for violations 4. Communicate policy 5. Document all sanctions 6. Apply sanctions consistently 7. Review sanction effectiveness", "• Sanction policy • Violation categories • Sanction specifications • Policy communication records • Sanction documentation • Consistency reviews • Effectiveness assessments", "1. Review sanction policy 2. Verify categories defined 3. Check sanctions specified 4. Verify policy communicated 5. Sample sanction applications 6. Test consistency 7. Review effectiveness", "✓ Sanction policy defined ✓ Violation categories clear ✓ Policy communicated ✓ Sanctions applied consistently", "MEDIUM", "Administrative"},
            {"§164.308(a)(1)(ii)(D)", "Information System Activity Review (R)", "Regularly review system activity records", "1. Define review procedures 2. Implement logging 3. Schedule regular reviews 4. Review access logs 5. Review security logs 6. Document review findings 7. Track remediation", "• Review procedures • Logging implementation • Review schedule • Access log reviews • Security log reviews • Review findings documentation • Remediation tracking", "1. Review procedures defined 2. Verify logging in place 3. Check review schedule followed 4. Sample log reviews 5. Verify findings documented 6. Check remediation tracked", "✓ Review procedures defined ✓ Regular reviews conducted ✓ Findings documented ✓ Remediation tracked", "HIGH", "Monitoring"},
            {"§164.308(a)(2)", "Assigned Security Responsibility (R)", "Identify security official", "1. Designate Security Official 2. Document responsibilities 3. Provide adequate authority 4. Allocate sufficient resources 5. Report to senior management 6. Document organizational placement", "• Security Official designation letter • Job description • Authority documentation • Resource allocation • Organizational chart • Reporting structure", "1. Verify Security Official designated 2. Review responsibilities documented 3. Check adequate authority 4. Validate resources sufficient 5. Confirm reporting to senior mgmt 6. Review organizational placement", "✓ Security Official designated ✓ Responsibilities documented ✓ Adequate authority and resources ✓ Reports to senior management", "CRITICAL", "Governance"},
            {"§164.308(a)(3)(i)", "Workforce Security", "Ensure workforce has appropriate access to ePHI", "1. Implement access authorization 2. Define workforce clearance 3. Establish termination procedures 4. Document all workforce access 5. Review workforce access quarterly 6. Implement background checks 7. Provide training", "• Workforce security policy • Access authorization procedures • Clearance procedures • Termination checklists • Workforce access matrix • Quarterly reviews • Background checks • Training completion", "1. Review workforce security procedures 2. Verify authorization process 3. Check clearance procedures 4. Test termination revocation 5. Review quarterly reviews 6. Validate background checks 7. Confirm training requirements", "✓ Workforce security procedures ✓ Authorization required ✓ Termination procedures enforced ✓ Quarterly reviews completed", "CRITICAL", "Workforce"},
            {"§164.308(a)(4)(i)", "Information Access Management", "Policies for authorizing ePHI access", "1. Implement RBAC 2. Define access authorization workflow 3. Establish minimum necessary 4. Document access determination 5. Review and approve all requests 6. Implement access logging 7. Conduct periodic access audits", "• Access management policy • RBAC implementation • Access request forms • Minimum necessary documentation • Access determination criteria • Access approval logs • Access audit reports", "1. Review access management policy 2. Verify RBAC implemented 3. Test access request workflow 4. Check minimum necessary applied 5. Review access approval process 6. Validate access logging 7. Review access audit findings", "✓ Access management policy ✓ RBAC implemented ✓ Minimum necessary enforced ✓ All requests approved ✓ Regular audits conducted", "CRITICAL", "Access Mgmt"},
            {"§164.308(a)(5)(i)", "Security Awareness and Training", "Security training for all workforce", "1. Develop annual security training 2. Provide HIPAA-specific training 3. Train on ePHI handling 4. Conduct phishing awareness 5. Provide role-based training 6. Train on incident reporting 7. Track completion 8. Test effectiveness", "• Training program plan • HIPAA training modules • ePHI handling procedures • Phishing awareness materials • Role-based curriculum • Incident reporting training • Training completion records (100%) • Effectiveness assessments", "1. Review training program 2. Verify all workforce completed 3. Check HIPAA-specific content 4. Review phishing simulation results 5. Validate role-based training 6. Test incident reporting knowledge 7. Assess effectiveness scores", "✓ Annual security training for all ✓ 100% completion rate ✓ HIPAA-specific training ✓ Phishing awareness active ✓ Effectiveness measured", "CRITICAL", "Training"},
            {"§164.308(a)(6)(i)", "Security Incident Procedures", "Policies to address security incidents", "1. Develop IR plan 2. Define incident categories 3. Establish IRT 4. Create incident reporting procedures 5. Implement incident tracking 6. Define escalation 7. Test IR quarterly 8. Document all incidents", "• Incident response plan • Incident categorization • IRT roster • Incident reporting procedures (24/7) • Incident tracking system • Escalation matrix • Tabletop exercise reports • Incident log", "1. Review IR plan current 2. Verify incident categories 3. Check IRT trained 4. Test 24/7 reporting 5. Review incident tracking 6. Validate escalation 7. Verify quarterly testing 8. Review all logged incidents", "✓ Current IR plan ✓ IRT trained ✓ 24/7 reporting ✓ Quarterly testing completed ✓ All incidents logged", "CRITICAL", "Incident Response"},
            {"§164.308(a)(7)(ii)(A)", "Data Backup Plan (R)", "Create retrievable exact copies of ePHI", "1. Implement automated daily backups 2. Backup all ePHI systems 3. Encrypt backup data (AES-256) 4. Store backups offsite or cloud 5. Test restores quarterly 6. Document backup procedures 7. Monitor backup success (99%+) 8. Implement versioning (30-day)", "• Backup policy • Backup schedules • Success/failure logs (99%+ success) • Encryption evidence • Offsite backup agreements • Quarterly restore test results • Backup monitoring dashboards • Versioning config", "1. Verify daily backups configured 2. Check all ePHI systems backed up 3. Test backup encryption 4. Verify offsite storage 5. Review quarterly restore tests 6. Check backup success rate (99%+) 7. Validate 30-day version retention 8. Test backup integrity", "✓ Automated daily backups ✓ All ePHI backed up ✓ Backups encrypted ✓ Offsite copies maintained ✓ Quarterly restores successful ✓ Success rate > 99%", "CRITICAL", "Business Continuity"},
            {"§164.308(a)(7)(ii)(B)", "Disaster Recovery Plan (R)", "Procedures to restore data loss", "1. Develop comprehensive DR plan 2. Define RTOs and RPOs 3. Document recovery procedures 4. Test recovery annually 5. Maintain DR site or cloud failover 6. Train DR team 7. Update plan when infrastructure changes", "• Disaster recovery plan • RTO/RPO documentation • Recovery procedures • Annual DR test reports • DR site/cloud failover evidence • DR team training records • Plan update history • Recovery runbooks", "1. Review DR plan completeness 2. Verify RTOs/RPOs defined 3. Check annual testing completed 4. Validate DR site or failover ready 5. Confirm DR team trained 6. Review test results 7. Test critical system recovery 8. Verify plan is current", "✓ DR plan comprehensive and current ✓ RTOs/RPOs defined for all systems ✓ Annual DR test passed ✓ DR team trained ✓ Recovery capabilities verified", "CRITICAL", "Business Continuity"},
            {"§164.308(b)(1)", "Business Associate Contracts (R)", "Obtain assurances BAs will safeguard ePHI", "1. Identify all business associates 2. Execute BAAs 3. Include all required HIPAA clauses 4. Specify permitted uses 5. Require incident notification 6. Include audit rights 7. Review BAAs annually 8. Terminate BAAs when services end", "• Business associate inventory • Executed BAA documents • BAA template with required clauses • Permitted use documentation • Incident notification procedures • Audit rights evidence • Annual BAA reviews • BAA termination records", "1. Verify all BAs identified 2. Check BAAs executed for all 3. Review BAA includes required clauses 4. Validate permitted uses specified 5. Confirm incident notification clause 6. Verify audit rights included 7. Check annual reviews completed 8. Test BA compliance monitoring", "✓ All business associates identified ✓ BAAs executed with all BAs ✓ All required HIPAA clauses included ✓ Annual reviews performed ✓ BA compliance monitored", "CRITICAL", "Business Associates"},
            {"§164.310(a)(1)", "Facility Access Controls", "Limit physical access to systems and facilities", "1. Implement card access control 2. Install surveillance cameras 3. Maintain visitor logs 4. Require visitor escorts 5. Implement alarm systems 6. Control access to server rooms 7. Conduct access audits monthly 8. Respond to access violations", "• Facility access control policy • Card access system • CCTV system and coverage maps • Visitor logs • Visitor escort procedures • Alarm system config • Server room access logs • Monthly access audit reports • Access violation response records", "1. Review facility access policy 2. Test card access system 3. Verify CCTV coverage adequate 4. Sample visitor logs for compliance 5. Check escort procedures followed 6. Test alarm system functionality 7. Review server room access controls 8. Verify monthly audits completed", "✓ Card access for all facilities ✓ CCTV covering all entry points ✓ All visitors logged and escorted ✓ Server rooms highly restricted ✓ Monthly access audits performed", "CRITICAL", "Physical Security"},
            {"§164.310(b)", "Workstation Use (R)", "Specify proper workstation functions and attributes", "1. Define workstation security policy 2. Specify authorized workstation locations 3. Implement automatic screen lock (10 min) 4. Require clean desk policy 5. Position workstations away from public view 6. Implement privacy screens 7. Prohibit ePHI access from home devices (unless secured)", "• Workstation use policy • Authorized workstation locations • Screen lock config (10 min) • Clean desk policy • Workstation positioning guidelines • Privacy screen inventory • Remote access policy • Workstation compliance inspections", "1. Review workstation use policy 2. Verify screen lock enforced 3. Check workstation positioning 4. Test clean desk compliance 5. Verify privacy screens deployed 6. Review remote access controls 7. Conduct workstation inspections", "✓ Workstation policy documented ✓ Screen lock enforced ✓ Privacy screens on public-facing stations ✓ Clean desk policy enforced ✓ Remote access secured", "HIGH", "Workstation"},
            {"§164.310(d)(1)", "Device and Media Controls", "Govern receipt and removal of hardware/media with ePHI", "1. Track all media containing ePHI 2. Implement secure disposal 3. Sanitize media before reuse/disposal 4. Maintain disposal records 5. Control media movement in/out 6. Encrypt all portable media 7. Implement media accountability", "• Device and media control policy • Media inventory and tracking • Secure disposal procedures (shredding/degaussing) • Disposal certificates • Media movement logs • Encryption verification for portable media • Media accountability records", "1. Review device and media policy 2. Verify media tracking system 3. Check disposal procedures secure 4. Review disposal certificates 5. Test media sanitization process 6. Verify portable media encrypted 7. Audit media accountability", "✓ All media tracked ✓ Secure disposal procedures ✓ Media sanitized before disposal/reuse ✓ Disposal documented ✓ Portable media encrypted", "HIGH", "Media Controls"},
            {"§164.312(a)(1)", "Access Control", "Allow access only to authorized persons/software", "1. Implement user-based access control 2. Deploy unique user IDs 3. Configure automatic logoff (30 min) 4. Implement encryption for ePHI 5. Enable audit logging 6. Implement emergency access 7. Review access logs daily", "• Access control technical policy • User ID assignment records • Auto-logoff config (30 min) • Encryption implementation (AES-256) • Audit log config • Emergency access procedures • Daily access log reviews", "1. Verify access control policy 2. Check unique user IDs 3. Test automatic logoff 4. Verify ePHI encryption 5. Review audit logging 6. Test emergency access 7. Validate daily log reviews", "✓ Unique user IDs for all ✓ Auto-logoff configured ✓ ePHI encrypted (AES-256) ✓ Audit logging enabled ✓ Daily log reviews", "CRITICAL", "Access Control"},
            {"§164.312(a)(2)(i)", "Unique User Identification (R)", "Assign unique name/number for user identity", "1. Implement unique user ID scheme 2. Prohibit shared accounts 3. Assign IDs upon provisioning 4. Link IDs to individual identity 5. Track all activities by ID 6. Deactivate IDs upon termination 7. Audit for shared accounts", "• Unique user ID policy • User ID database • Shared account prohibition policy • User provisioning records • Activity tracking logs by user ID • Termination ID deactivation records • Shared account audit results", "1. Verify unique ID policy 2. Check all users have unique IDs 3. Scan for shared accounts 4. Test ID assignment process 5. Review activity tracking by ID 6. Verify IDs deactivated at termination 7. Audit for shared credentials", "✓ All users have unique IDs ✓ No shared accounts ✓ Activity tracked by user ID ✓ IDs deactivated upon termination", "CRITICAL", "User ID"},
            {"§164.312(a)(2)(ii)", "Emergency Access Procedure (R)", "Procedures for obtaining ePHI during emergency", "1. Define emergency scenarios 2. Document break-glass procedures 3. Implement emergency access accounts 4. Log all emergency access usage 5. Review emergency access logs 6. Require justification 7. Test procedures annually", "• Emergency access policy • Break-glass procedures • Emergency access accounts • Emergency access logs • Access review procedures • Justification documentation • Annual test results", "1. Review emergency access policy 2. Verify break-glass documented 3. Check emergency accounts secured 4. Review emergency usage logs 5. Verify justifications documented 6. Test emergency procedures 7. Validate access quickly available", "✓ Emergency access procedures ✓ Break-glass mechanism ✓ All emergency access logged ✓ Annual testing completed ✓ Access available when needed", "HIGH", "Emergency Access"},
            {"§164.312(a)(2)(iv)", "Encryption and Decryption (A)", "Mechanism to encrypt and decrypt ePHI", "1. Encrypt all ePHI at rest (AES-256) 2. Encrypt ePHI in transit (TLS 1.3) 3. Implement database encryption (TDE) 4. Encrypt portable media/devices 5. Use encrypted email for ePHI 6. Implement key management 7. Document encryption 8. Conduct risk assessment if not encrypting", "• Encryption policy • At-rest encryption (AES-256) • TLS 1.3 implementation • Database TDE configuration • Device encryption (BitLocker/FileVault) • Encrypted email solution • Key management procedures • Risk assessment for unencrypted ePHI", "1. Verify all ePHI encrypted at rest 2. Test TLS 1.3 enforcement 3. Check database TDE enabled 4. Verify all devices encrypted 5. Test encrypted email usage 6. Review key management 7. If not encrypting, verify risk assessment 8. Scan for unencrypted ePHI", "✓ AES-256 for all ePHI at rest ✓ TLS 1.3 for all ePHI in transit ✓ All devices encrypted ✓ Encrypted email for ePHI ✓ Risk assessment if unencrypted", "CRITICAL", "Encryption"},
            {"§164.312(b)", "Audit Controls (R)", "Record and examine system activity", "1. Enable logging on all ePHI systems 2. Log authentication events 3. Log all ePHI access/modifications 4. Centralize logs in SIEM 5. Retain logs 6 years 6. Review logs daily 7. Generate audit reports 8. Alert on suspicious activity", "• Audit control policy • Logging configuration • SIEM implementation • Log retention config (6 years) • Daily log review procedures • Audit reports • Alerting rules • Investigation records", "1. Verify logging on all ePHI systems 2. Check authentication logging 3. Test ePHI access logging 4. Verify logs centralized in SIEM 5. Confirm 6-year retention 6. Review daily log analysis 7. Test alerting mechanisms 8. Sample investigations", "✓ Comprehensive logging ✓ All ePHI access logged ✓ Logs centralized and retained 6 years ✓ Daily log review ✓ Alerts configured", "CRITICAL", "Audit Logging"},
            {"§164.312(c)(1)", "Integrity Controls", "Protect ePHI from improper alteration/destruction", "1. Implement data integrity controls 2. Use checksums/hashing 3. Implement version control 4. Enable audit logging for changes 5. Implement access controls for modifications 6. Test data integrity regularly 7. Monitor for unauthorized changes", "• Data integrity policy • Integrity verification (checksums) • Version control system • Change audit logs • Modification access controls • Integrity testing procedures • Unauthorized change alerts • Data integrity reports", "1. Review integrity control policy 2. Verify integrity mechanisms 3. Test checksum/hash verification 4. Check version control usage 5. Review change logs 6. Validate integrity testing 7. Test unauthorized change detection", "✓ Integrity controls implemented ✓ Checksums/hashing used ✓ Version control in place ✓ All changes logged ✓ Regular integrity testing", "HIGH", "Data Integrity"},
            {"§164.312(d)", "Person/Entity Authentication (R)", "Verify person seeking access is the one claimed", "1. Implement MFA 2. Use certificate-based authentication 3. Deploy biometric for high-security 4. Implement SSO with strong auth 5. Monitor authentication failures 6. Disable accounts after failed attempts (5) 7. Require password complexity 8. Implement session timeout", "• Authentication policy • MFA deployment (100% of users) • Certificate infrastructure • Biometric system docs • SSO configuration • Failed authentication monitoring • Account lockout (5 attempts) • Password complexity requirements • Session timeout (30 min)", "1. Verify MFA enabled for all 2. Test certificate authentication 3. Check biometric systems 4. Validate SSO authentication 5. Review failed login monitoring 6. Test account lockout 7. Verify password complexity 8. Test session timeout", "✓ MFA required for all ePHI access ✓ Strong authentication methods ✓ Failed attempts monitored ✓ Account lockout configured ✓ Session timeout enforced", "CRITICAL", "Authentication"},
            {"§164.312(e)(1)", "Transmission Security", "Guard against unauthorized access during transmission", "1. Enforce TLS 1.3 for all ePHI transmission 2. Prohibit unencrypted email of ePHI 3. Implement encrypted messaging 4. Use VPN for remote ePHI access 5. Implement network segmentation 6. Monitor network traffic 7. Implement IDS/IPS 8. Document all transmission methods", "• Transmission security policy • TLS 1.3 enforcement evidence • Encrypted email solution (S/MIME or PGP) • Secure messaging platform • VPN configuration • Network segmentation documentation • IDS/IPS deployment • Network monitoring logs • Transmission method inventory", "1. Verify TLS 1.3 enforced 2. Test email encryption 3. Check secure messaging usage 4. Verify VPN for remote access 5. Review network segmentation 6. Test IDS/IPS effectiveness 7. Review transmission monitoring 8. Scan for unencrypted transmissions", "✓ TLS 1.3 for all ePHI transmission ✓ No unencrypted email of ePHI ✓ VPN required for remote access ✓ Network segmentation implemented ✓ IDS/IPS monitoring traffic", "CRITICAL", "Transmission Security"}
        };
        for (String[] req : hipaa) items.add(new DetailedChecklistItem(req[0], req[1], req[2], req[3], req[4], req[5], req[6], req[7], req[8]));

        log.info("✅ Generated {} complete HIPAA requirements", items.size());
        return items;
    }

    private List<DetailedChecklistItem> getGenericChecklist(String standard) {
        List<DetailedChecklistItem> items = new ArrayList<>();
        items.add(new DetailedChecklistItem("GEN-001", "Policy Documentation", "Document and maintain compliance policies for " + standard, "Develop, approve, publish and maintain policy documentation", "Policy documents, approval records, distribution logs", "Verify policies exist, current, and communicated", "Policies approved and communicated within 12 months", "HIGH", "Governance"));
        items.add(new DetailedChecklistItem("GEN-002", "Risk Assessment", "Conduct regular risk assessments for " + standard, "Perform annual risk assessment covering all controls", "Risk assessment reports, risk register, management approvals", "Review risk methodology and recent reports", "Risk assessment completed within 12 months", "HIGH", "Risk Mgmt"));
        return items;
    }

    private static class DetailedChecklistItem {
        String controlId, controlName, detailedDescription, implementationGuidance, evidenceRequired, testingProcedure, complianceCriteria, priority, category;

        DetailedChecklistItem(String controlId, String controlName, String detailedDescription, String implementationGuidance, String evidenceRequired, String testingProcedure, String complianceCriteria, String priority, String category) {
            this.controlId = controlId;
            this.controlName = controlName;
            this.detailedDescription = detailedDescription;
            this.implementationGuidance = implementationGuidance;
            this.evidenceRequired = evidenceRequired;
            this.testingProcedure = testingProcedure;
            this.complianceCriteria = complianceCriteria;
            this.priority = priority;
            this.category = category;
        }
    }
}